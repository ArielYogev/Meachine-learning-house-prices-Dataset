<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>7db178c97ee0432c93e00d17a3309eea</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<div class="cell markdown">
<p>Ariel Yogev 207917501 Guy Ben Moshe 318363397</p>
</div>
<div class="cell markdown">
<p><a href="https://www.kaggle.com/guybenmoshe">Kaggle</a></p>
</div>
<div class="cell markdown">
<p><strong>About</strong></p>
<blockquote>
<p>In this competition, we focused on predicting house prices based on
given data. During our work, we identified which features influence
house prices more and tried to create a model that best predicts the
house price. We tried to predict house prices by using Linear regression
and also by SGD regression for comparing what will provied the best
score and the lowest RMSE.</p>
</blockquote>
</div>
<div class="cell code" data-execution_count="35"
data-_cell_guid="b1076dfc-b9ad-4769-8c92-a6c4dae69d19"
data-_uuid="8f2839f25d086af736a60e9eeb907d3b93b6e0e5"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-08-09T10:49:09.863261Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-08-09T10:49:09.861957Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-08-09T10:49:09.875352Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-08-09T10:49:09.873932Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-08-09T10:49:09.863144Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb1"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># import numpy, matplotlib, etc.</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.express <span class="im">as</span> px</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.graph_objects <span class="im">as</span> go</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> ydata_profiling <span class="im">import</span> ProfileReport</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># sklearn imports</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn <span class="im">import</span> metrics</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn <span class="im">import</span> pipeline</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn <span class="im">import</span> linear_model</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn <span class="im">import</span> preprocessing</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn <span class="im">import</span> neural_network</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn <span class="im">import</span> model_selection</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.pipeline <span class="im">import</span> Pipeline</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> KFold</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.pipeline <span class="im">import</span> make_pipeline</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> LeavePOut</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> SGDRegressor</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> SGDClassifier</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> mean_squared_error</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> OneHotEncoder</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> OrdinalEncoder</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LinearRegression</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> PolynomialFeatures</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> LabelEncoder</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a><span class="co"># This Python 3 environment comes with many helpful analytics libraries installed</span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a><span class="co"># It is defined by the kaggle/python Docker image: https://github.com/kaggle/docker-python</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a><span class="co"># For example, here&#39;s several helpful packages to load</span></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np <span class="co"># linear algebra</span></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd <span class="co"># data processing, CSV file I/O (e.g. pd.read_csv)</span></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Input data files are available in the read-only &quot;../input/&quot; directory</span></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a><span class="co"># For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory</span></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> dirname, _, filenames <span class="kw">in</span> os.walk(<span class="st">&#39;/kaggle/input&#39;</span>):</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> filename <span class="kw">in</span> filenames:</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(os.path.join(dirname, filename))</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a><span class="co"># You can write up to 20GB to the current directory (/kaggle/working/) that gets preserved as output when you create a version using &quot;Save &amp; Run All&quot; </span></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a><span class="co"># You can also write temporary files to /kaggle/temp/, but they won&#39;t be saved outside of the current session</span></span></code></pre></div>
<div class="output stream stdout">
<pre><code>/kaggle/input/house-prices-advanced-regression-techniques/sample_submission.csv
/kaggle/input/house-prices-advanced-regression-techniques/data_description.txt
/kaggle/input/house-prices-advanced-regression-techniques/train.csv
/kaggle/input/house-prices-advanced-regression-techniques/test.csv
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="36"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-08-09T10:49:09.877893Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-08-09T10:49:09.877473Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-08-09T10:49:09.898662Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-08-09T10:49:09.897388Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-08-09T10:49:09.877861Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb3"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.io <span class="im">as</span> pio</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>pio.renderers.default <span class="op">=</span><span class="st">&#39;notebook&#39;</span></span></code></pre></div>
</div>
<div class="cell code" data-execution_count="37"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-08-09T10:49:10.157505Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-08-09T10:49:10.157064Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-08-09T10:49:10.205663Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-08-09T10:49:10.204304Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-08-09T10:49:10.157469Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb4"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>hp_train_df <span class="op">=</span> pd.read_csv(<span class="st">&quot;/kaggle/input/house-prices-advanced-regression-techniques/train.csv&quot;</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>hp_train_df.reset_index(drop<span class="op">=</span><span class="va">True</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>display(hp_train_df)</span></code></pre></div>
<div class="output display_data">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Id</th>
      <th>MSSubClass</th>
      <th>MSZoning</th>
      <th>LotFrontage</th>
      <th>LotArea</th>
      <th>Street</th>
      <th>Alley</th>
      <th>LotShape</th>
      <th>LandContour</th>
      <th>Utilities</th>
      <th>...</th>
      <th>PoolArea</th>
      <th>PoolQC</th>
      <th>Fence</th>
      <th>MiscFeature</th>
      <th>MiscVal</th>
      <th>MoSold</th>
      <th>YrSold</th>
      <th>SaleType</th>
      <th>SaleCondition</th>
      <th>SalePrice</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>60</td>
      <td>RL</td>
      <td>65.0</td>
      <td>8450</td>
      <td>Pave</td>
      <td>NaN</td>
      <td>Reg</td>
      <td>Lvl</td>
      <td>AllPub</td>
      <td>...</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>2</td>
      <td>2008</td>
      <td>WD</td>
      <td>Normal</td>
      <td>208500</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>20</td>
      <td>RL</td>
      <td>80.0</td>
      <td>9600</td>
      <td>Pave</td>
      <td>NaN</td>
      <td>Reg</td>
      <td>Lvl</td>
      <td>AllPub</td>
      <td>...</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>5</td>
      <td>2007</td>
      <td>WD</td>
      <td>Normal</td>
      <td>181500</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>60</td>
      <td>RL</td>
      <td>68.0</td>
      <td>11250</td>
      <td>Pave</td>
      <td>NaN</td>
      <td>IR1</td>
      <td>Lvl</td>
      <td>AllPub</td>
      <td>...</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>9</td>
      <td>2008</td>
      <td>WD</td>
      <td>Normal</td>
      <td>223500</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>70</td>
      <td>RL</td>
      <td>60.0</td>
      <td>9550</td>
      <td>Pave</td>
      <td>NaN</td>
      <td>IR1</td>
      <td>Lvl</td>
      <td>AllPub</td>
      <td>...</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>2</td>
      <td>2006</td>
      <td>WD</td>
      <td>Abnorml</td>
      <td>140000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>60</td>
      <td>RL</td>
      <td>84.0</td>
      <td>14260</td>
      <td>Pave</td>
      <td>NaN</td>
      <td>IR1</td>
      <td>Lvl</td>
      <td>AllPub</td>
      <td>...</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>12</td>
      <td>2008</td>
      <td>WD</td>
      <td>Normal</td>
      <td>250000</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1455</th>
      <td>1456</td>
      <td>60</td>
      <td>RL</td>
      <td>62.0</td>
      <td>7917</td>
      <td>Pave</td>
      <td>NaN</td>
      <td>Reg</td>
      <td>Lvl</td>
      <td>AllPub</td>
      <td>...</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>8</td>
      <td>2007</td>
      <td>WD</td>
      <td>Normal</td>
      <td>175000</td>
    </tr>
    <tr>
      <th>1456</th>
      <td>1457</td>
      <td>20</td>
      <td>RL</td>
      <td>85.0</td>
      <td>13175</td>
      <td>Pave</td>
      <td>NaN</td>
      <td>Reg</td>
      <td>Lvl</td>
      <td>AllPub</td>
      <td>...</td>
      <td>0</td>
      <td>NaN</td>
      <td>MnPrv</td>
      <td>NaN</td>
      <td>0</td>
      <td>2</td>
      <td>2010</td>
      <td>WD</td>
      <td>Normal</td>
      <td>210000</td>
    </tr>
    <tr>
      <th>1457</th>
      <td>1458</td>
      <td>70</td>
      <td>RL</td>
      <td>66.0</td>
      <td>9042</td>
      <td>Pave</td>
      <td>NaN</td>
      <td>Reg</td>
      <td>Lvl</td>
      <td>AllPub</td>
      <td>...</td>
      <td>0</td>
      <td>NaN</td>
      <td>GdPrv</td>
      <td>Shed</td>
      <td>2500</td>
      <td>5</td>
      <td>2010</td>
      <td>WD</td>
      <td>Normal</td>
      <td>266500</td>
    </tr>
    <tr>
      <th>1458</th>
      <td>1459</td>
      <td>20</td>
      <td>RL</td>
      <td>68.0</td>
      <td>9717</td>
      <td>Pave</td>
      <td>NaN</td>
      <td>Reg</td>
      <td>Lvl</td>
      <td>AllPub</td>
      <td>...</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>4</td>
      <td>2010</td>
      <td>WD</td>
      <td>Normal</td>
      <td>142125</td>
    </tr>
    <tr>
      <th>1459</th>
      <td>1460</td>
      <td>20</td>
      <td>RL</td>
      <td>75.0</td>
      <td>9937</td>
      <td>Pave</td>
      <td>NaN</td>
      <td>Reg</td>
      <td>Lvl</td>
      <td>AllPub</td>
      <td>...</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>6</td>
      <td>2008</td>
      <td>WD</td>
      <td>Normal</td>
      <td>147500</td>
    </tr>
  </tbody>
</table>
<p>1460 rows × 81 columns</p>
</div>
</div>
</div>
<div class="cell markdown">
<p>the full table before changes</p>
</div>
<div class="cell code" data-execution_count="38"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-08-09T10:49:10.274667Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-08-09T10:49:10.274129Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-08-09T10:49:10.295709Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-08-09T10:49:10.294447Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-08-09T10:49:10.274624Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb5"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>hp_train_df.info()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 1460 entries, 0 to 1459
Data columns (total 81 columns):
 #   Column         Non-Null Count  Dtype  
---  ------         --------------  -----  
 0   Id             1460 non-null   int64  
 1   MSSubClass     1460 non-null   int64  
 2   MSZoning       1460 non-null   object 
 3   LotFrontage    1201 non-null   float64
 4   LotArea        1460 non-null   int64  
 5   Street         1460 non-null   object 
 6   Alley          91 non-null     object 
 7   LotShape       1460 non-null   object 
 8   LandContour    1460 non-null   object 
 9   Utilities      1460 non-null   object 
 10  LotConfig      1460 non-null   object 
 11  LandSlope      1460 non-null   object 
 12  Neighborhood   1460 non-null   object 
 13  Condition1     1460 non-null   object 
 14  Condition2     1460 non-null   object 
 15  BldgType       1460 non-null   object 
 16  HouseStyle     1460 non-null   object 
 17  OverallQual    1460 non-null   int64  
 18  OverallCond    1460 non-null   int64  
 19  YearBuilt      1460 non-null   int64  
 20  YearRemodAdd   1460 non-null   int64  
 21  RoofStyle      1460 non-null   object 
 22  RoofMatl       1460 non-null   object 
 23  Exterior1st    1460 non-null   object 
 24  Exterior2nd    1460 non-null   object 
 25  MasVnrType     588 non-null    object 
 26  MasVnrArea     1452 non-null   float64
 27  ExterQual      1460 non-null   object 
 28  ExterCond      1460 non-null   object 
 29  Foundation     1460 non-null   object 
 30  BsmtQual       1423 non-null   object 
 31  BsmtCond       1423 non-null   object 
 32  BsmtExposure   1422 non-null   object 
 33  BsmtFinType1   1423 non-null   object 
 34  BsmtFinSF1     1460 non-null   int64  
 35  BsmtFinType2   1422 non-null   object 
 36  BsmtFinSF2     1460 non-null   int64  
 37  BsmtUnfSF      1460 non-null   int64  
 38  TotalBsmtSF    1460 non-null   int64  
 39  Heating        1460 non-null   object 
 40  HeatingQC      1460 non-null   object 
 41  CentralAir     1460 non-null   object 
 42  Electrical     1459 non-null   object 
 43  1stFlrSF       1460 non-null   int64  
 44  2ndFlrSF       1460 non-null   int64  
 45  LowQualFinSF   1460 non-null   int64  
 46  GrLivArea      1460 non-null   int64  
 47  BsmtFullBath   1460 non-null   int64  
 48  BsmtHalfBath   1460 non-null   int64  
 49  FullBath       1460 non-null   int64  
 50  HalfBath       1460 non-null   int64  
 51  BedroomAbvGr   1460 non-null   int64  
 52  KitchenAbvGr   1460 non-null   int64  
 53  KitchenQual    1460 non-null   object 
 54  TotRmsAbvGrd   1460 non-null   int64  
 55  Functional     1460 non-null   object 
 56  Fireplaces     1460 non-null   int64  
 57  FireplaceQu    770 non-null    object 
 58  GarageType     1379 non-null   object 
 59  GarageYrBlt    1379 non-null   float64
 60  GarageFinish   1379 non-null   object 
 61  GarageCars     1460 non-null   int64  
 62  GarageArea     1460 non-null   int64  
 63  GarageQual     1379 non-null   object 
 64  GarageCond     1379 non-null   object 
 65  PavedDrive     1460 non-null   object 
 66  WoodDeckSF     1460 non-null   int64  
 67  OpenPorchSF    1460 non-null   int64  
 68  EnclosedPorch  1460 non-null   int64  
 69  3SsnPorch      1460 non-null   int64  
 70  ScreenPorch    1460 non-null   int64  
 71  PoolArea       1460 non-null   int64  
 72  PoolQC         7 non-null      object 
 73  Fence          281 non-null    object 
 74  MiscFeature    54 non-null     object 
 75  MiscVal        1460 non-null   int64  
 76  MoSold         1460 non-null   int64  
 77  YrSold         1460 non-null   int64  
 78  SaleType       1460 non-null   object 
 79  SaleCondition  1460 non-null   object 
 80  SalePrice      1460 non-null   int64  
dtypes: float64(3), int64(35), object(43)
memory usage: 924.0+ KB
</code></pre>
</div>
</div>
<div class="cell markdown">
<p>We can see that thare are colunms with null values</p>
</div>
<div class="cell markdown">
<p><strong>#report</strong></p>
</div>
<div class="cell code" data-execution_count="39"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-08-09T10:49:10.298602Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-08-09T10:49:10.298074Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-08-09T10:49:10.311972Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-08-09T10:49:10.310773Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-08-09T10:49:10.298557Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb7"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">&#39;&#39;&#39;</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co">#report</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co">ProfileReport(hp_train_df, title=&quot;House prices Profiling Report&quot;,explorative=True)</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co">&#39;&#39;&#39;</span></span></code></pre></div>
<div class="output execute_result" data-execution_count="39">
<pre><code>&#39;\n#report\nProfileReport(hp_train_df, title=&quot;House prices Profiling Report&quot;,explorative=True)\n&#39;</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="40"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-08-09T10:49:10.314116Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-08-09T10:49:10.313770Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-08-09T10:49:10.331276Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-08-09T10:49:10.329951Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-08-09T10:49:10.314087Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb9"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>missing_values <span class="op">=</span> hp_train_df.isnull().<span class="bu">sum</span>()</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>missing_values <span class="op">=</span> missing_values[missing_values <span class="op">&gt;</span> <span class="dv">0</span>]</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>missing_percentage <span class="op">=</span> (missing_values <span class="op">/</span> <span class="bu">len</span>(hp_train_df)) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(missing_percentage)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>LotFrontage     17.739726
Alley           93.767123
MasVnrType      59.726027
MasVnrArea       0.547945
BsmtQual         2.534247
BsmtCond         2.534247
BsmtExposure     2.602740
BsmtFinType1     2.534247
BsmtFinType2     2.602740
Electrical       0.068493
FireplaceQu     47.260274
GarageType       5.547945
GarageYrBlt      5.547945
GarageFinish     5.547945
GarageQual       5.547945
GarageCond       5.547945
PoolQC          99.520548
Fence           80.753425
MiscFeature     96.301370
dtype: float64
</code></pre>
</div>
</div>
<div class="cell markdown">
<p>We wanted to see how much precent of each colunm is null.</p>
</div>
<div class="cell code" data-execution_count="41"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-08-09T10:49:10.333750Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-08-09T10:49:10.332924Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-08-09T10:49:10.357215Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-08-09T10:49:10.355792Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-08-09T10:49:10.333713Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb11"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>hp_train_df_ch <span class="op">=</span> hp_train_df.copy()</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>columns_to_drop <span class="op">=</span> missing_percentage[missing_percentage <span class="op">&gt;</span> <span class="dv">60</span>].index</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>hp_train_df_ch.drop(columns<span class="op">=</span>columns_to_drop, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(hp_train_df_ch)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>        Id  MSSubClass MSZoning  LotFrontage  LotArea Street LotShape  \
0        1          60       RL         65.0     8450   Pave      Reg   
1        2          20       RL         80.0     9600   Pave      Reg   
2        3          60       RL         68.0    11250   Pave      IR1   
3        4          70       RL         60.0     9550   Pave      IR1   
4        5          60       RL         84.0    14260   Pave      IR1   
...    ...         ...      ...          ...      ...    ...      ...   
1455  1456          60       RL         62.0     7917   Pave      Reg   
1456  1457          20       RL         85.0    13175   Pave      Reg   
1457  1458          70       RL         66.0     9042   Pave      Reg   
1458  1459          20       RL         68.0     9717   Pave      Reg   
1459  1460          20       RL         75.0     9937   Pave      Reg   

     LandContour Utilities LotConfig  ... EnclosedPorch 3SsnPorch ScreenPorch  \
0            Lvl    AllPub    Inside  ...             0         0           0   
1            Lvl    AllPub       FR2  ...             0         0           0   
2            Lvl    AllPub    Inside  ...             0         0           0   
3            Lvl    AllPub    Corner  ...           272         0           0   
4            Lvl    AllPub       FR2  ...             0         0           0   
...          ...       ...       ...  ...           ...       ...         ...   
1455         Lvl    AllPub    Inside  ...             0         0           0   
1456         Lvl    AllPub    Inside  ...             0         0           0   
1457         Lvl    AllPub    Inside  ...             0         0           0   
1458         Lvl    AllPub    Inside  ...           112         0           0   
1459         Lvl    AllPub    Inside  ...             0         0           0   

     PoolArea MiscVal MoSold  YrSold  SaleType  SaleCondition  SalePrice  
0           0       0      2    2008        WD         Normal     208500  
1           0       0      5    2007        WD         Normal     181500  
2           0       0      9    2008        WD         Normal     223500  
3           0       0      2    2006        WD        Abnorml     140000  
4           0       0     12    2008        WD         Normal     250000  
...       ...     ...    ...     ...       ...            ...        ...  
1455        0       0      8    2007        WD         Normal     175000  
1456        0       0      2    2010        WD         Normal     210000  
1457        0    2500      5    2010        WD         Normal     266500  
1458        0       0      4    2010        WD         Normal     142125  
1459        0       0      6    2008        WD         Normal     147500  

[1460 rows x 77 columns]
</code></pre>
</div>
</div>
<div class="cell markdown">
<p>We decided to drop colunms with more than 40% null values</p>
</div>
<div class="cell code" data-execution_count="42"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-08-09T10:49:10.541063Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-08-09T10:49:10.540661Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-08-09T10:49:10.569625Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-08-09T10:49:10.568477Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-08-09T10:49:10.541036Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb13"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>hp_train_df_ch</span></code></pre></div>
<div class="output execute_result" data-execution_count="42">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Id</th>
      <th>MSSubClass</th>
      <th>MSZoning</th>
      <th>LotFrontage</th>
      <th>LotArea</th>
      <th>Street</th>
      <th>LotShape</th>
      <th>LandContour</th>
      <th>Utilities</th>
      <th>LotConfig</th>
      <th>...</th>
      <th>EnclosedPorch</th>
      <th>3SsnPorch</th>
      <th>ScreenPorch</th>
      <th>PoolArea</th>
      <th>MiscVal</th>
      <th>MoSold</th>
      <th>YrSold</th>
      <th>SaleType</th>
      <th>SaleCondition</th>
      <th>SalePrice</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>60</td>
      <td>RL</td>
      <td>65.0</td>
      <td>8450</td>
      <td>Pave</td>
      <td>Reg</td>
      <td>Lvl</td>
      <td>AllPub</td>
      <td>Inside</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>2008</td>
      <td>WD</td>
      <td>Normal</td>
      <td>208500</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>20</td>
      <td>RL</td>
      <td>80.0</td>
      <td>9600</td>
      <td>Pave</td>
      <td>Reg</td>
      <td>Lvl</td>
      <td>AllPub</td>
      <td>FR2</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>5</td>
      <td>2007</td>
      <td>WD</td>
      <td>Normal</td>
      <td>181500</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>60</td>
      <td>RL</td>
      <td>68.0</td>
      <td>11250</td>
      <td>Pave</td>
      <td>IR1</td>
      <td>Lvl</td>
      <td>AllPub</td>
      <td>Inside</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>9</td>
      <td>2008</td>
      <td>WD</td>
      <td>Normal</td>
      <td>223500</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>70</td>
      <td>RL</td>
      <td>60.0</td>
      <td>9550</td>
      <td>Pave</td>
      <td>IR1</td>
      <td>Lvl</td>
      <td>AllPub</td>
      <td>Corner</td>
      <td>...</td>
      <td>272</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>2006</td>
      <td>WD</td>
      <td>Abnorml</td>
      <td>140000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>60</td>
      <td>RL</td>
      <td>84.0</td>
      <td>14260</td>
      <td>Pave</td>
      <td>IR1</td>
      <td>Lvl</td>
      <td>AllPub</td>
      <td>FR2</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>12</td>
      <td>2008</td>
      <td>WD</td>
      <td>Normal</td>
      <td>250000</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1455</th>
      <td>1456</td>
      <td>60</td>
      <td>RL</td>
      <td>62.0</td>
      <td>7917</td>
      <td>Pave</td>
      <td>Reg</td>
      <td>Lvl</td>
      <td>AllPub</td>
      <td>Inside</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>8</td>
      <td>2007</td>
      <td>WD</td>
      <td>Normal</td>
      <td>175000</td>
    </tr>
    <tr>
      <th>1456</th>
      <td>1457</td>
      <td>20</td>
      <td>RL</td>
      <td>85.0</td>
      <td>13175</td>
      <td>Pave</td>
      <td>Reg</td>
      <td>Lvl</td>
      <td>AllPub</td>
      <td>Inside</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>2010</td>
      <td>WD</td>
      <td>Normal</td>
      <td>210000</td>
    </tr>
    <tr>
      <th>1457</th>
      <td>1458</td>
      <td>70</td>
      <td>RL</td>
      <td>66.0</td>
      <td>9042</td>
      <td>Pave</td>
      <td>Reg</td>
      <td>Lvl</td>
      <td>AllPub</td>
      <td>Inside</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2500</td>
      <td>5</td>
      <td>2010</td>
      <td>WD</td>
      <td>Normal</td>
      <td>266500</td>
    </tr>
    <tr>
      <th>1458</th>
      <td>1459</td>
      <td>20</td>
      <td>RL</td>
      <td>68.0</td>
      <td>9717</td>
      <td>Pave</td>
      <td>Reg</td>
      <td>Lvl</td>
      <td>AllPub</td>
      <td>Inside</td>
      <td>...</td>
      <td>112</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>4</td>
      <td>2010</td>
      <td>WD</td>
      <td>Normal</td>
      <td>142125</td>
    </tr>
    <tr>
      <th>1459</th>
      <td>1460</td>
      <td>20</td>
      <td>RL</td>
      <td>75.0</td>
      <td>9937</td>
      <td>Pave</td>
      <td>Reg</td>
      <td>Lvl</td>
      <td>AllPub</td>
      <td>Inside</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>6</td>
      <td>2008</td>
      <td>WD</td>
      <td>Normal</td>
      <td>147500</td>
    </tr>
  </tbody>
</table>
<p>1460 rows × 77 columns</p>
</div>
</div>
</div>
<div class="cell code" data-execution_count="43"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-08-09T10:49:10.814431Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-08-09T10:49:10.813223Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-08-09T10:49:10.844978Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-08-09T10:49:10.843623Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-08-09T10:49:10.814361Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb14"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>hp_train_df_ch.drop(columns<span class="op">=</span>[<span class="st">&#39;Id&#39;</span>], inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>hp_train_df_ch</span></code></pre></div>
<div class="output execute_result" data-execution_count="43">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>MSSubClass</th>
      <th>MSZoning</th>
      <th>LotFrontage</th>
      <th>LotArea</th>
      <th>Street</th>
      <th>LotShape</th>
      <th>LandContour</th>
      <th>Utilities</th>
      <th>LotConfig</th>
      <th>LandSlope</th>
      <th>...</th>
      <th>EnclosedPorch</th>
      <th>3SsnPorch</th>
      <th>ScreenPorch</th>
      <th>PoolArea</th>
      <th>MiscVal</th>
      <th>MoSold</th>
      <th>YrSold</th>
      <th>SaleType</th>
      <th>SaleCondition</th>
      <th>SalePrice</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>60</td>
      <td>RL</td>
      <td>65.0</td>
      <td>8450</td>
      <td>Pave</td>
      <td>Reg</td>
      <td>Lvl</td>
      <td>AllPub</td>
      <td>Inside</td>
      <td>Gtl</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>2008</td>
      <td>WD</td>
      <td>Normal</td>
      <td>208500</td>
    </tr>
    <tr>
      <th>1</th>
      <td>20</td>
      <td>RL</td>
      <td>80.0</td>
      <td>9600</td>
      <td>Pave</td>
      <td>Reg</td>
      <td>Lvl</td>
      <td>AllPub</td>
      <td>FR2</td>
      <td>Gtl</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>5</td>
      <td>2007</td>
      <td>WD</td>
      <td>Normal</td>
      <td>181500</td>
    </tr>
    <tr>
      <th>2</th>
      <td>60</td>
      <td>RL</td>
      <td>68.0</td>
      <td>11250</td>
      <td>Pave</td>
      <td>IR1</td>
      <td>Lvl</td>
      <td>AllPub</td>
      <td>Inside</td>
      <td>Gtl</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>9</td>
      <td>2008</td>
      <td>WD</td>
      <td>Normal</td>
      <td>223500</td>
    </tr>
    <tr>
      <th>3</th>
      <td>70</td>
      <td>RL</td>
      <td>60.0</td>
      <td>9550</td>
      <td>Pave</td>
      <td>IR1</td>
      <td>Lvl</td>
      <td>AllPub</td>
      <td>Corner</td>
      <td>Gtl</td>
      <td>...</td>
      <td>272</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>2006</td>
      <td>WD</td>
      <td>Abnorml</td>
      <td>140000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>60</td>
      <td>RL</td>
      <td>84.0</td>
      <td>14260</td>
      <td>Pave</td>
      <td>IR1</td>
      <td>Lvl</td>
      <td>AllPub</td>
      <td>FR2</td>
      <td>Gtl</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>12</td>
      <td>2008</td>
      <td>WD</td>
      <td>Normal</td>
      <td>250000</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1455</th>
      <td>60</td>
      <td>RL</td>
      <td>62.0</td>
      <td>7917</td>
      <td>Pave</td>
      <td>Reg</td>
      <td>Lvl</td>
      <td>AllPub</td>
      <td>Inside</td>
      <td>Gtl</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>8</td>
      <td>2007</td>
      <td>WD</td>
      <td>Normal</td>
      <td>175000</td>
    </tr>
    <tr>
      <th>1456</th>
      <td>20</td>
      <td>RL</td>
      <td>85.0</td>
      <td>13175</td>
      <td>Pave</td>
      <td>Reg</td>
      <td>Lvl</td>
      <td>AllPub</td>
      <td>Inside</td>
      <td>Gtl</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>2010</td>
      <td>WD</td>
      <td>Normal</td>
      <td>210000</td>
    </tr>
    <tr>
      <th>1457</th>
      <td>70</td>
      <td>RL</td>
      <td>66.0</td>
      <td>9042</td>
      <td>Pave</td>
      <td>Reg</td>
      <td>Lvl</td>
      <td>AllPub</td>
      <td>Inside</td>
      <td>Gtl</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2500</td>
      <td>5</td>
      <td>2010</td>
      <td>WD</td>
      <td>Normal</td>
      <td>266500</td>
    </tr>
    <tr>
      <th>1458</th>
      <td>20</td>
      <td>RL</td>
      <td>68.0</td>
      <td>9717</td>
      <td>Pave</td>
      <td>Reg</td>
      <td>Lvl</td>
      <td>AllPub</td>
      <td>Inside</td>
      <td>Gtl</td>
      <td>...</td>
      <td>112</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>4</td>
      <td>2010</td>
      <td>WD</td>
      <td>Normal</td>
      <td>142125</td>
    </tr>
    <tr>
      <th>1459</th>
      <td>20</td>
      <td>RL</td>
      <td>75.0</td>
      <td>9937</td>
      <td>Pave</td>
      <td>Reg</td>
      <td>Lvl</td>
      <td>AllPub</td>
      <td>Inside</td>
      <td>Gtl</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>6</td>
      <td>2008</td>
      <td>WD</td>
      <td>Normal</td>
      <td>147500</td>
    </tr>
  </tbody>
</table>
<p>1460 rows × 76 columns</p>
</div>
</div>
</div>
<div class="cell markdown">
<p>We dropped the id feature neither.</p>
</div>
<div class="cell code" data-execution_count="44"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-08-09T10:49:10.846794Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-08-09T10:49:10.846452Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-08-09T10:49:10.873453Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-08-09T10:49:10.872332Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-08-09T10:49:10.846761Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb15"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Find columns with only one unique value</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>single_value_columns <span class="op">=</span> [col <span class="cf">for</span> col <span class="kw">in</span> hp_train_df_ch.columns <span class="cf">if</span> hp_train_df_ch[col].nunique() <span class="op">==</span> <span class="dv">1</span>]</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop the columns with only one unique value</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>hp_train_df_ch <span class="op">=</span> hp_train_df_ch.drop(columns<span class="op">=</span>single_value_columns)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the cleaned DataFrame</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Dropped columns:&quot;</span>, single_value_columns)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Dropped columns: []
</code></pre>
</div>
</div>
<div class="cell markdown">
<p>We checked if there is a columns with only one uniq value. we can see
that there isn't.</p>
</div>
<div class="cell code" data-execution_count="45"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-08-09T10:49:11.108897Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-08-09T10:49:11.108470Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-08-09T10:49:11.187377Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-08-09T10:49:11.186185Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-08-09T10:49:11.108866Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb17"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> column <span class="kw">in</span> hp_train_df_ch.columns:</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> hp_train_df_ch[column].dtype <span class="op">==</span> <span class="st">&quot;float64&quot;</span> <span class="kw">or</span> hp_train_df_ch[column].dtype <span class="op">==</span> <span class="st">&quot;int64&quot;</span>:</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>        hp_train_df_ch[column] <span class="op">=</span> hp_train_df_ch[column].fillna(hp_train_df_ch[column].median())</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>        hp_train_df_ch[column] <span class="op">=</span> hp_train_df_ch[column].fillna(hp_train_df_ch[column].mode()[<span class="dv">0</span>])</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>hp_train_df_ch.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="45">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>MSSubClass</th>
      <th>MSZoning</th>
      <th>LotFrontage</th>
      <th>LotArea</th>
      <th>Street</th>
      <th>LotShape</th>
      <th>LandContour</th>
      <th>Utilities</th>
      <th>LotConfig</th>
      <th>LandSlope</th>
      <th>...</th>
      <th>EnclosedPorch</th>
      <th>3SsnPorch</th>
      <th>ScreenPorch</th>
      <th>PoolArea</th>
      <th>MiscVal</th>
      <th>MoSold</th>
      <th>YrSold</th>
      <th>SaleType</th>
      <th>SaleCondition</th>
      <th>SalePrice</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>60</td>
      <td>RL</td>
      <td>65.0</td>
      <td>8450</td>
      <td>Pave</td>
      <td>Reg</td>
      <td>Lvl</td>
      <td>AllPub</td>
      <td>Inside</td>
      <td>Gtl</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>2008</td>
      <td>WD</td>
      <td>Normal</td>
      <td>208500</td>
    </tr>
    <tr>
      <th>1</th>
      <td>20</td>
      <td>RL</td>
      <td>80.0</td>
      <td>9600</td>
      <td>Pave</td>
      <td>Reg</td>
      <td>Lvl</td>
      <td>AllPub</td>
      <td>FR2</td>
      <td>Gtl</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>5</td>
      <td>2007</td>
      <td>WD</td>
      <td>Normal</td>
      <td>181500</td>
    </tr>
    <tr>
      <th>2</th>
      <td>60</td>
      <td>RL</td>
      <td>68.0</td>
      <td>11250</td>
      <td>Pave</td>
      <td>IR1</td>
      <td>Lvl</td>
      <td>AllPub</td>
      <td>Inside</td>
      <td>Gtl</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>9</td>
      <td>2008</td>
      <td>WD</td>
      <td>Normal</td>
      <td>223500</td>
    </tr>
    <tr>
      <th>3</th>
      <td>70</td>
      <td>RL</td>
      <td>60.0</td>
      <td>9550</td>
      <td>Pave</td>
      <td>IR1</td>
      <td>Lvl</td>
      <td>AllPub</td>
      <td>Corner</td>
      <td>Gtl</td>
      <td>...</td>
      <td>272</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>2006</td>
      <td>WD</td>
      <td>Abnorml</td>
      <td>140000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>60</td>
      <td>RL</td>
      <td>84.0</td>
      <td>14260</td>
      <td>Pave</td>
      <td>IR1</td>
      <td>Lvl</td>
      <td>AllPub</td>
      <td>FR2</td>
      <td>Gtl</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>12</td>
      <td>2008</td>
      <td>WD</td>
      <td>Normal</td>
      <td>250000</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 76 columns</p>
</div>
</div>
</div>
<div class="cell markdown">
<p>Here we replaced numeric missing values with the avarege value and an
objects missing values with the most frequent value of that column.</p>
</div>
<div class="cell code" data-execution_count="46"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-08-09T10:49:11.189921Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-08-09T10:49:11.189567Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-08-09T10:49:11.206659Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-08-09T10:49:11.205425Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-08-09T10:49:11.189890Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb18"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>hp_train_df_ch.isnull().<span class="bu">sum</span>().<span class="bu">sum</span>()</span></code></pre></div>
<div class="output execute_result" data-execution_count="46">
<pre><code>0</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="47"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-08-09T10:49:11.208277Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-08-09T10:49:11.207942Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-08-09T10:49:11.236565Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-08-09T10:49:11.235477Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-08-09T10:49:11.208249Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb20"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>hp_train_df_ch.info()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 1460 entries, 0 to 1459
Data columns (total 76 columns):
 #   Column         Non-Null Count  Dtype  
---  ------         --------------  -----  
 0   MSSubClass     1460 non-null   int64  
 1   MSZoning       1460 non-null   object 
 2   LotFrontage    1460 non-null   float64
 3   LotArea        1460 non-null   int64  
 4   Street         1460 non-null   object 
 5   LotShape       1460 non-null   object 
 6   LandContour    1460 non-null   object 
 7   Utilities      1460 non-null   object 
 8   LotConfig      1460 non-null   object 
 9   LandSlope      1460 non-null   object 
 10  Neighborhood   1460 non-null   object 
 11  Condition1     1460 non-null   object 
 12  Condition2     1460 non-null   object 
 13  BldgType       1460 non-null   object 
 14  HouseStyle     1460 non-null   object 
 15  OverallQual    1460 non-null   int64  
 16  OverallCond    1460 non-null   int64  
 17  YearBuilt      1460 non-null   int64  
 18  YearRemodAdd   1460 non-null   int64  
 19  RoofStyle      1460 non-null   object 
 20  RoofMatl       1460 non-null   object 
 21  Exterior1st    1460 non-null   object 
 22  Exterior2nd    1460 non-null   object 
 23  MasVnrType     1460 non-null   object 
 24  MasVnrArea     1460 non-null   float64
 25  ExterQual      1460 non-null   object 
 26  ExterCond      1460 non-null   object 
 27  Foundation     1460 non-null   object 
 28  BsmtQual       1460 non-null   object 
 29  BsmtCond       1460 non-null   object 
 30  BsmtExposure   1460 non-null   object 
 31  BsmtFinType1   1460 non-null   object 
 32  BsmtFinSF1     1460 non-null   int64  
 33  BsmtFinType2   1460 non-null   object 
 34  BsmtFinSF2     1460 non-null   int64  
 35  BsmtUnfSF      1460 non-null   int64  
 36  TotalBsmtSF    1460 non-null   int64  
 37  Heating        1460 non-null   object 
 38  HeatingQC      1460 non-null   object 
 39  CentralAir     1460 non-null   object 
 40  Electrical     1460 non-null   object 
 41  1stFlrSF       1460 non-null   int64  
 42  2ndFlrSF       1460 non-null   int64  
 43  LowQualFinSF   1460 non-null   int64  
 44  GrLivArea      1460 non-null   int64  
 45  BsmtFullBath   1460 non-null   int64  
 46  BsmtHalfBath   1460 non-null   int64  
 47  FullBath       1460 non-null   int64  
 48  HalfBath       1460 non-null   int64  
 49  BedroomAbvGr   1460 non-null   int64  
 50  KitchenAbvGr   1460 non-null   int64  
 51  KitchenQual    1460 non-null   object 
 52  TotRmsAbvGrd   1460 non-null   int64  
 53  Functional     1460 non-null   object 
 54  Fireplaces     1460 non-null   int64  
 55  FireplaceQu    1460 non-null   object 
 56  GarageType     1460 non-null   object 
 57  GarageYrBlt    1460 non-null   float64
 58  GarageFinish   1460 non-null   object 
 59  GarageCars     1460 non-null   int64  
 60  GarageArea     1460 non-null   int64  
 61  GarageQual     1460 non-null   object 
 62  GarageCond     1460 non-null   object 
 63  PavedDrive     1460 non-null   object 
 64  WoodDeckSF     1460 non-null   int64  
 65  OpenPorchSF    1460 non-null   int64  
 66  EnclosedPorch  1460 non-null   int64  
 67  3SsnPorch      1460 non-null   int64  
 68  ScreenPorch    1460 non-null   int64  
 69  PoolArea       1460 non-null   int64  
 70  MiscVal        1460 non-null   int64  
 71  MoSold         1460 non-null   int64  
 72  YrSold         1460 non-null   int64  
 73  SaleType       1460 non-null   object 
 74  SaleCondition  1460 non-null   object 
 75  SalePrice      1460 non-null   int64  
dtypes: float64(3), int64(34), object(39)
memory usage: 867.0+ KB
</code></pre>
</div>
</div>
<div class="cell markdown">
<p>We can see that we took care of all the missing values and now we can
start train the model</p>
</div>
<div class="cell code" data-execution_count="48"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-08-09T10:49:11.412822Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-08-09T10:49:11.412360Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-08-09T10:49:11.444256Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-08-09T10:49:11.443139Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-08-09T10:49:11.412789Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb22"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>hp_train_df_ch</span></code></pre></div>
<div class="output execute_result" data-execution_count="48">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>MSSubClass</th>
      <th>MSZoning</th>
      <th>LotFrontage</th>
      <th>LotArea</th>
      <th>Street</th>
      <th>LotShape</th>
      <th>LandContour</th>
      <th>Utilities</th>
      <th>LotConfig</th>
      <th>LandSlope</th>
      <th>...</th>
      <th>EnclosedPorch</th>
      <th>3SsnPorch</th>
      <th>ScreenPorch</th>
      <th>PoolArea</th>
      <th>MiscVal</th>
      <th>MoSold</th>
      <th>YrSold</th>
      <th>SaleType</th>
      <th>SaleCondition</th>
      <th>SalePrice</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>60</td>
      <td>RL</td>
      <td>65.0</td>
      <td>8450</td>
      <td>Pave</td>
      <td>Reg</td>
      <td>Lvl</td>
      <td>AllPub</td>
      <td>Inside</td>
      <td>Gtl</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>2008</td>
      <td>WD</td>
      <td>Normal</td>
      <td>208500</td>
    </tr>
    <tr>
      <th>1</th>
      <td>20</td>
      <td>RL</td>
      <td>80.0</td>
      <td>9600</td>
      <td>Pave</td>
      <td>Reg</td>
      <td>Lvl</td>
      <td>AllPub</td>
      <td>FR2</td>
      <td>Gtl</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>5</td>
      <td>2007</td>
      <td>WD</td>
      <td>Normal</td>
      <td>181500</td>
    </tr>
    <tr>
      <th>2</th>
      <td>60</td>
      <td>RL</td>
      <td>68.0</td>
      <td>11250</td>
      <td>Pave</td>
      <td>IR1</td>
      <td>Lvl</td>
      <td>AllPub</td>
      <td>Inside</td>
      <td>Gtl</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>9</td>
      <td>2008</td>
      <td>WD</td>
      <td>Normal</td>
      <td>223500</td>
    </tr>
    <tr>
      <th>3</th>
      <td>70</td>
      <td>RL</td>
      <td>60.0</td>
      <td>9550</td>
      <td>Pave</td>
      <td>IR1</td>
      <td>Lvl</td>
      <td>AllPub</td>
      <td>Corner</td>
      <td>Gtl</td>
      <td>...</td>
      <td>272</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>2006</td>
      <td>WD</td>
      <td>Abnorml</td>
      <td>140000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>60</td>
      <td>RL</td>
      <td>84.0</td>
      <td>14260</td>
      <td>Pave</td>
      <td>IR1</td>
      <td>Lvl</td>
      <td>AllPub</td>
      <td>FR2</td>
      <td>Gtl</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>12</td>
      <td>2008</td>
      <td>WD</td>
      <td>Normal</td>
      <td>250000</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1455</th>
      <td>60</td>
      <td>RL</td>
      <td>62.0</td>
      <td>7917</td>
      <td>Pave</td>
      <td>Reg</td>
      <td>Lvl</td>
      <td>AllPub</td>
      <td>Inside</td>
      <td>Gtl</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>8</td>
      <td>2007</td>
      <td>WD</td>
      <td>Normal</td>
      <td>175000</td>
    </tr>
    <tr>
      <th>1456</th>
      <td>20</td>
      <td>RL</td>
      <td>85.0</td>
      <td>13175</td>
      <td>Pave</td>
      <td>Reg</td>
      <td>Lvl</td>
      <td>AllPub</td>
      <td>Inside</td>
      <td>Gtl</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>2010</td>
      <td>WD</td>
      <td>Normal</td>
      <td>210000</td>
    </tr>
    <tr>
      <th>1457</th>
      <td>70</td>
      <td>RL</td>
      <td>66.0</td>
      <td>9042</td>
      <td>Pave</td>
      <td>Reg</td>
      <td>Lvl</td>
      <td>AllPub</td>
      <td>Inside</td>
      <td>Gtl</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2500</td>
      <td>5</td>
      <td>2010</td>
      <td>WD</td>
      <td>Normal</td>
      <td>266500</td>
    </tr>
    <tr>
      <th>1458</th>
      <td>20</td>
      <td>RL</td>
      <td>68.0</td>
      <td>9717</td>
      <td>Pave</td>
      <td>Reg</td>
      <td>Lvl</td>
      <td>AllPub</td>
      <td>Inside</td>
      <td>Gtl</td>
      <td>...</td>
      <td>112</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>4</td>
      <td>2010</td>
      <td>WD</td>
      <td>Normal</td>
      <td>142125</td>
    </tr>
    <tr>
      <th>1459</th>
      <td>20</td>
      <td>RL</td>
      <td>75.0</td>
      <td>9937</td>
      <td>Pave</td>
      <td>Reg</td>
      <td>Lvl</td>
      <td>AllPub</td>
      <td>Inside</td>
      <td>Gtl</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>6</td>
      <td>2008</td>
      <td>WD</td>
      <td>Normal</td>
      <td>147500</td>
    </tr>
  </tbody>
</table>
<p>1460 rows × 76 columns</p>
</div>
</div>
</div>
<div class="cell code" data-execution_count="49"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-08-09T10:49:11.446517Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-08-09T10:49:11.446102Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-08-09T10:49:15.208571Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-08-09T10:49:15.207157Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-08-09T10:49:11.446477Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb23"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">25</span>,<span class="dv">15</span>))</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>cor <span class="op">=</span> hp_train_df_ch.select_dtypes(exclude<span class="op">=</span>[<span class="st">&#39;object&#39;</span>]).corr()</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>sns.heatmap(cor, annot<span class="op">=</span><span class="va">True</span>, cmap<span class="op">=</span>plt.cm.Greens, vmin<span class="op">=-</span><span class="dv">1</span>, vmax<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_4fa37495b4184bc2901899a734acb6ec/849c995129e1b8db3f633cd79c25446b1c38596a.png" /></p>
</div>
</div>
<div class="cell markdown">
<p>Correlation table before features drop</p>
</div>
<div class="cell code" data-execution_count="50"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-08-09T10:49:15.211112Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-08-09T10:49:15.210695Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-08-09T10:49:15.219434Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-08-09T10:49:15.218435Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-08-09T10:49:15.211077Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb24"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>hp_train_df_ch.columns</span></code></pre></div>
<div class="output execute_result" data-execution_count="50">
<pre><code>Index([&#39;MSSubClass&#39;, &#39;MSZoning&#39;, &#39;LotFrontage&#39;, &#39;LotArea&#39;, &#39;Street&#39;,
       &#39;LotShape&#39;, &#39;LandContour&#39;, &#39;Utilities&#39;, &#39;LotConfig&#39;, &#39;LandSlope&#39;,
       &#39;Neighborhood&#39;, &#39;Condition1&#39;, &#39;Condition2&#39;, &#39;BldgType&#39;, &#39;HouseStyle&#39;,
       &#39;OverallQual&#39;, &#39;OverallCond&#39;, &#39;YearBuilt&#39;, &#39;YearRemodAdd&#39;, &#39;RoofStyle&#39;,
       &#39;RoofMatl&#39;, &#39;Exterior1st&#39;, &#39;Exterior2nd&#39;, &#39;MasVnrType&#39;, &#39;MasVnrArea&#39;,
       &#39;ExterQual&#39;, &#39;ExterCond&#39;, &#39;Foundation&#39;, &#39;BsmtQual&#39;, &#39;BsmtCond&#39;,
       &#39;BsmtExposure&#39;, &#39;BsmtFinType1&#39;, &#39;BsmtFinSF1&#39;, &#39;BsmtFinType2&#39;,
       &#39;BsmtFinSF2&#39;, &#39;BsmtUnfSF&#39;, &#39;TotalBsmtSF&#39;, &#39;Heating&#39;, &#39;HeatingQC&#39;,
       &#39;CentralAir&#39;, &#39;Electrical&#39;, &#39;1stFlrSF&#39;, &#39;2ndFlrSF&#39;, &#39;LowQualFinSF&#39;,
       &#39;GrLivArea&#39;, &#39;BsmtFullBath&#39;, &#39;BsmtHalfBath&#39;, &#39;FullBath&#39;, &#39;HalfBath&#39;,
       &#39;BedroomAbvGr&#39;, &#39;KitchenAbvGr&#39;, &#39;KitchenQual&#39;, &#39;TotRmsAbvGrd&#39;,
       &#39;Functional&#39;, &#39;Fireplaces&#39;, &#39;FireplaceQu&#39;, &#39;GarageType&#39;, &#39;GarageYrBlt&#39;,
       &#39;GarageFinish&#39;, &#39;GarageCars&#39;, &#39;GarageArea&#39;, &#39;GarageQual&#39;, &#39;GarageCond&#39;,
       &#39;PavedDrive&#39;, &#39;WoodDeckSF&#39;, &#39;OpenPorchSF&#39;, &#39;EnclosedPorch&#39;, &#39;3SsnPorch&#39;,
       &#39;ScreenPorch&#39;, &#39;PoolArea&#39;, &#39;MiscVal&#39;, &#39;MoSold&#39;, &#39;YrSold&#39;, &#39;SaleType&#39;,
       &#39;SaleCondition&#39;, &#39;SalePrice&#39;],
      dtype=&#39;object&#39;)</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="51"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-08-09T10:49:15.221904Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-08-09T10:49:15.220922Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-08-09T10:49:15.252884Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-08-09T10:49:15.251664Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-08-09T10:49:15.221864Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb26"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>hp_train_df_ch_drop <span class="op">=</span> hp_train_df_ch.copy()</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Assuming df is your dataframe and &#39;target&#39; is the name of your target variable column</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>target <span class="op">=</span> <span class="st">&#39;SalePrice&#39;</span>  <span class="co"># Replace with actual target variable name</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>corr_threshold <span class="op">=</span> <span class="fl">0.1</span>  <span class="co"># Set your correlation threshold</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate correlations with the target variable</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>correlations <span class="op">=</span> hp_train_df_ch_drop.select_dtypes(exclude<span class="op">=</span>[<span class="st">&#39;object&#39;</span>]).corr()[target].<span class="bu">abs</span>()</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify features with correlation less than the threshold</span></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>low_corr_features <span class="op">=</span> correlations[correlations <span class="op">&lt;</span> corr_threshold].index.tolist()</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop these features from your dataframe</span></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>hp_train_df_ch_drop <span class="op">=</span> hp_train_df_ch_drop.drop(low_corr_features, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Now df contains only the features that have at least 20% correlation with the target variable</span></span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>low_corr_features</span></code></pre></div>
<div class="output execute_result" data-execution_count="51">
<pre><code>[&#39;MSSubClass&#39;,
 &#39;OverallCond&#39;,
 &#39;BsmtFinSF2&#39;,
 &#39;LowQualFinSF&#39;,
 &#39;BsmtHalfBath&#39;,
 &#39;3SsnPorch&#39;,
 &#39;PoolArea&#39;,
 &#39;MiscVal&#39;,
 &#39;MoSold&#39;,
 &#39;YrSold&#39;]</code></pre>
</div>
</div>
<div class="cell markdown">
<p>Here we decided to drop features that has less than 20% correlation
with target</p>
</div>
<div class="cell code" data-execution_count="52"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-08-09T10:49:15.256904Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-08-09T10:49:15.256408Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-08-09T10:49:17.362082Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-08-09T10:49:17.360910Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-08-09T10:49:15.256863Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb28"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">20</span>,<span class="dv">15</span>))</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>cor <span class="op">=</span> hp_train_df_ch_drop.select_dtypes(exclude<span class="op">=</span>[<span class="st">&#39;object&#39;</span>]).corr()</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>sns.heatmap(cor, annot<span class="op">=</span><span class="va">True</span>, cmap<span class="op">=</span>plt.cm.Blues, vmin<span class="op">=-</span><span class="dv">1</span>, vmax<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_4fa37495b4184bc2901899a734acb6ec/f598aa0975a6b21b9503369cb7e2804363905392.png" /></p>
</div>
</div>
<div class="cell markdown">
<p>Here we can see the correlation table. we can tell that the feature
'overallQual'has very high correlation with the target for example</p>
</div>
<div class="cell code" data-execution_count="53"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-08-09T10:49:17.363745Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-08-09T10:49:17.363398Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-08-09T10:49:17.371829Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-08-09T10:49:17.370508Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-08-09T10:49:17.363718Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb29"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> hp_train_df_ch_drop[<span class="st">&#39;SalePrice&#39;</span>].copy()</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> hp_train_df_ch_drop.drop([<span class="st">&#39;SalePrice&#39;</span>], axis<span class="op">=</span><span class="dv">1</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="54"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-08-09T10:49:17.373951Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-08-09T10:49:17.373428Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-08-09T10:49:17.391479Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-08-09T10:49:17.390263Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-08-09T10:49:17.373907Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb30"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>numerical_cols <span class="op">=</span> X.select_dtypes(include<span class="op">=</span>[<span class="st">&#39;int64&#39;</span>, <span class="st">&#39;float64&#39;</span>]).columns</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>categorical_cols <span class="op">=</span> X.select_dtypes(include<span class="op">=</span>[<span class="st">&#39;object&#39;</span>, <span class="st">&#39;bool&#39;</span>]).columns</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>all_cols <span class="op">=</span> np.array(X.columns)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;Numerical Cols:&#39;</span>, numerical_cols)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;Categorical Cols:&#39;</span>, categorical_cols)</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;All Cols:&#39;</span>, all_cols)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Numerical Cols: Index([&#39;LotFrontage&#39;, &#39;LotArea&#39;, &#39;OverallQual&#39;, &#39;YearBuilt&#39;, &#39;YearRemodAdd&#39;,
       &#39;MasVnrArea&#39;, &#39;BsmtFinSF1&#39;, &#39;BsmtUnfSF&#39;, &#39;TotalBsmtSF&#39;, &#39;1stFlrSF&#39;,
       &#39;2ndFlrSF&#39;, &#39;GrLivArea&#39;, &#39;BsmtFullBath&#39;, &#39;FullBath&#39;, &#39;HalfBath&#39;,
       &#39;BedroomAbvGr&#39;, &#39;KitchenAbvGr&#39;, &#39;TotRmsAbvGrd&#39;, &#39;Fireplaces&#39;,
       &#39;GarageYrBlt&#39;, &#39;GarageCars&#39;, &#39;GarageArea&#39;, &#39;WoodDeckSF&#39;, &#39;OpenPorchSF&#39;,
       &#39;EnclosedPorch&#39;, &#39;ScreenPorch&#39;],
      dtype=&#39;object&#39;)
Categorical Cols: Index([&#39;MSZoning&#39;, &#39;Street&#39;, &#39;LotShape&#39;, &#39;LandContour&#39;, &#39;Utilities&#39;,
       &#39;LotConfig&#39;, &#39;LandSlope&#39;, &#39;Neighborhood&#39;, &#39;Condition1&#39;, &#39;Condition2&#39;,
       &#39;BldgType&#39;, &#39;HouseStyle&#39;, &#39;RoofStyle&#39;, &#39;RoofMatl&#39;, &#39;Exterior1st&#39;,
       &#39;Exterior2nd&#39;, &#39;MasVnrType&#39;, &#39;ExterQual&#39;, &#39;ExterCond&#39;, &#39;Foundation&#39;,
       &#39;BsmtQual&#39;, &#39;BsmtCond&#39;, &#39;BsmtExposure&#39;, &#39;BsmtFinType1&#39;, &#39;BsmtFinType2&#39;,
       &#39;Heating&#39;, &#39;HeatingQC&#39;, &#39;CentralAir&#39;, &#39;Electrical&#39;, &#39;KitchenQual&#39;,
       &#39;Functional&#39;, &#39;FireplaceQu&#39;, &#39;GarageType&#39;, &#39;GarageFinish&#39;, &#39;GarageQual&#39;,
       &#39;GarageCond&#39;, &#39;PavedDrive&#39;, &#39;SaleType&#39;, &#39;SaleCondition&#39;],
      dtype=&#39;object&#39;)
All Cols: [&#39;MSZoning&#39; &#39;LotFrontage&#39; &#39;LotArea&#39; &#39;Street&#39; &#39;LotShape&#39; &#39;LandContour&#39;
 &#39;Utilities&#39; &#39;LotConfig&#39; &#39;LandSlope&#39; &#39;Neighborhood&#39; &#39;Condition1&#39;
 &#39;Condition2&#39; &#39;BldgType&#39; &#39;HouseStyle&#39; &#39;OverallQual&#39; &#39;YearBuilt&#39;
 &#39;YearRemodAdd&#39; &#39;RoofStyle&#39; &#39;RoofMatl&#39; &#39;Exterior1st&#39; &#39;Exterior2nd&#39;
 &#39;MasVnrType&#39; &#39;MasVnrArea&#39; &#39;ExterQual&#39; &#39;ExterCond&#39; &#39;Foundation&#39; &#39;BsmtQual&#39;
 &#39;BsmtCond&#39; &#39;BsmtExposure&#39; &#39;BsmtFinType1&#39; &#39;BsmtFinSF1&#39; &#39;BsmtFinType2&#39;
 &#39;BsmtUnfSF&#39; &#39;TotalBsmtSF&#39; &#39;Heating&#39; &#39;HeatingQC&#39; &#39;CentralAir&#39; &#39;Electrical&#39;
 &#39;1stFlrSF&#39; &#39;2ndFlrSF&#39; &#39;GrLivArea&#39; &#39;BsmtFullBath&#39; &#39;FullBath&#39; &#39;HalfBath&#39;
 &#39;BedroomAbvGr&#39; &#39;KitchenAbvGr&#39; &#39;KitchenQual&#39; &#39;TotRmsAbvGrd&#39; &#39;Functional&#39;
 &#39;Fireplaces&#39; &#39;FireplaceQu&#39; &#39;GarageType&#39; &#39;GarageYrBlt&#39; &#39;GarageFinish&#39;
 &#39;GarageCars&#39; &#39;GarageArea&#39; &#39;GarageQual&#39; &#39;GarageCond&#39; &#39;PavedDrive&#39;
 &#39;WoodDeckSF&#39; &#39;OpenPorchSF&#39; &#39;EnclosedPorch&#39; &#39;ScreenPorch&#39; &#39;SaleType&#39;
 &#39;SaleCondition&#39;]
</code></pre>
</div>
</div>
<div class="cell markdown">
<p>Here we splits the columns by type for future encoding</p>
</div>
<div class="cell code" data-execution_count="55"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-08-09T10:49:17.393768Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-08-09T10:49:17.393268Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-08-09T10:49:17.407849Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-08-09T10:49:17.406548Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-08-09T10:49:17.393732Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb32"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.graph_objects <span class="im">as</span> go</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate score and loss from cv (KFold or LPO) and display graphs</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_cv_score_and_loss(X, t, model, transformer<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>                          k<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>                          p<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>                          show_score_loss_graphs<span class="op">=</span><span class="va">False</span>):</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>    scores_losses_df <span class="op">=</span> pd.DataFrame(columns<span class="op">=</span>[<span class="st">&#39;fold_id&#39;</span>, <span class="st">&#39;split&#39;</span>, <span class="st">&#39;score&#39;</span>, <span class="st">&#39;loss&#39;</span>])</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> k <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>        cv <span class="op">=</span> KFold(n_splits<span class="op">=</span>k, shuffle<span class="op">=</span><span class="va">True</span>,random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> p <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>        cv <span class="op">=</span> LeavePOut(p)</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="st">&#39;you need to specify k or p in order for the cv to work&#39;</span>)</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, (train_ids, val_ids) <span class="kw">in</span> <span class="bu">enumerate</span>(cv.split(X)):</span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>        <span class="co"># from index to record assignment</span></span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>        X_train <span class="op">=</span> X.loc[train_ids]</span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>        t_train <span class="op">=</span> t.loc[train_ids]</span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>        X_val <span class="op">=</span> X.loc[val_ids]</span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>        t_val <span class="op">=</span> t.loc[val_ids]</span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>        <span class="co"># fit and predict</span></span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a>        model.fit(X_train, t_train)</span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a>        y_train <span class="op">=</span> model.predict(X_train)</span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a>        y_val <span class="op">=</span> model.predict(X_val)</span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a>        <span class="co"># assign results into scores df</span></span>
<span id="cb32-30"><a href="#cb32-30" aria-hidden="true" tabindex="-1"></a>        scores_losses_df.loc[<span class="bu">len</span>(scores_losses_df)] <span class="op">=</span> [i, <span class="st">&#39;train&#39;</span>, model.score(X_train, t_train),</span>
<span id="cb32-31"><a href="#cb32-31" aria-hidden="true" tabindex="-1"></a>                                                       np.sqrt(mean_squared_error(t_train, y_train))]</span>
<span id="cb32-32"><a href="#cb32-32" aria-hidden="true" tabindex="-1"></a>        scores_losses_df.loc[<span class="bu">len</span>(scores_losses_df)] <span class="op">=</span>[i, <span class="st">&#39;val&#39;</span>, model.score(X_val, t_val),</span>
<span id="cb32-33"><a href="#cb32-33" aria-hidden="true" tabindex="-1"></a>                                                      np.sqrt(mean_squared_error(t_val, y_val))]</span>
<span id="cb32-34"><a href="#cb32-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-35"><a href="#cb32-35" aria-hidden="true" tabindex="-1"></a>    <span class="co">#split into two dfs , val and train</span></span>
<span id="cb32-36"><a href="#cb32-36" aria-hidden="true" tabindex="-1"></a>    val_scores_losses_df <span class="op">=</span> scores_losses_df[scores_losses_df[<span class="st">&#39;split&#39;</span>]<span class="op">==</span><span class="st">&#39;val&#39;</span>]</span>
<span id="cb32-37"><a href="#cb32-37" aria-hidden="true" tabindex="-1"></a>    train_scores_losses_df <span class="op">=</span> scores_losses_df[scores_losses_df[<span class="st">&#39;split&#39;</span>]<span class="op">==</span><span class="st">&#39;train&#39;</span>]</span>
<span id="cb32-38"><a href="#cb32-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-39"><a href="#cb32-39" aria-hidden="true" tabindex="-1"></a>    <span class="co">#calculate mean score and loss for train and validation across all models</span></span>
<span id="cb32-40"><a href="#cb32-40" aria-hidden="true" tabindex="-1"></a>    mean_val_score <span class="op">=</span> val_scores_losses_df[<span class="st">&#39;score&#39;</span>].mean()</span>
<span id="cb32-41"><a href="#cb32-41" aria-hidden="true" tabindex="-1"></a>    mean_val_loss <span class="op">=</span> val_scores_losses_df[<span class="st">&#39;loss&#39;</span>].mean()</span>
<span id="cb32-42"><a href="#cb32-42" aria-hidden="true" tabindex="-1"></a>    mean_train_score <span class="op">=</span> train_scores_losses_df[<span class="st">&#39;score&#39;</span>].mean()</span>
<span id="cb32-43"><a href="#cb32-43" aria-hidden="true" tabindex="-1"></a>    mean_train_loss <span class="op">=</span> train_scores_losses_df[<span class="st">&#39;loss&#39;</span>].mean()</span>
<span id="cb32-44"><a href="#cb32-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-45"><a href="#cb32-45" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> show_score_loss_graphs:</span>
<span id="cb32-46"><a href="#cb32-46" aria-hidden="true" tabindex="-1"></a>        fig <span class="op">=</span> px.line(scores_losses_df, x<span class="op">=</span><span class="st">&#39;fold_id&#39;</span>, y<span class="op">=</span><span class="st">&#39;score&#39;</span>, color<span class="op">=</span><span class="st">&#39;split&#39;</span>, title<span class="op">=</span><span class="ss">f&#39;Mean Val Score: </span><span class="sc">{</span>mean_val_score<span class="sc">:.2f}</span><span class="ss">, Mean Train Score: </span><span class="sc">{</span>mean_train_score<span class="sc">:.2f}</span><span class="ss">&#39;</span>)</span>
<span id="cb32-47"><a href="#cb32-47" aria-hidden="true" tabindex="-1"></a>        fig.show()</span>
<span id="cb32-48"><a href="#cb32-48" aria-hidden="true" tabindex="-1"></a>        fig <span class="op">=</span> px.line(scores_losses_df, x<span class="op">=</span><span class="st">&#39;fold_id&#39;</span>, y<span class="op">=</span><span class="st">&#39;loss&#39;</span>, color<span class="op">=</span><span class="st">&#39;split&#39;</span>, title<span class="op">=</span><span class="ss">f&#39;Mean Val Loss: </span><span class="sc">{</span>mean_val_loss<span class="sc">:.2f}</span><span class="ss">, Mean Train Loss: </span><span class="sc">{</span>mean_train_loss<span class="sc">:.2f}</span><span class="ss">&#39;</span>)</span>
<span id="cb32-49"><a href="#cb32-49" aria-hidden="true" tabindex="-1"></a>        fig.show()</span>
<span id="cb32-50"><a href="#cb32-50" aria-hidden="true" tabindex="-1"></a>        display(scores_losses_df)</span>
<span id="cb32-51"><a href="#cb32-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-52"><a href="#cb32-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-53"><a href="#cb32-53" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> mean_val_score, mean_val_loss, mean_train_score, mean_train_loss</span></code></pre></div>
</div>
<div class="cell markdown">
<p>Here we checked what is the model that will bring us the best
score</p>
</div>
<div class="cell code" data-execution_count="56"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-08-09T10:49:17.409584Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-08-09T10:49:17.409210Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-08-09T10:49:17.425630Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-08-09T10:49:17.424060Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-08-09T10:49:17.409555Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb33"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> evaluate_model(X, model):</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>    val_score, val_loss, train_score, train_loss <span class="op">=</span> get_cv_score_and_loss(X, t, model, k<span class="op">=</span><span class="dv">5</span>, show_score_loss_graphs<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&#39;mean cv val score: </span><span class="sc">{</span>val_score<span class="sc">:.2f}</span><span class="ch">\n</span><span class="ss">mean cv val loss </span><span class="sc">{</span>val_loss<span class="sc">:.2f}</span><span class="ss">&#39;</span>)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&#39;mean cv train score: </span><span class="sc">{</span>train_score<span class="sc">:.2f}</span><span class="ch">\n</span><span class="ss">mean cv train loss </span><span class="sc">{</span>train_loss<span class="sc">:.2f}</span><span class="ss">&#39;</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="57"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-08-09T10:49:17.428251Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-08-09T10:49:17.427733Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-08-09T10:49:17.483833Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-08-09T10:49:17.482813Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-08-09T10:49:17.428208Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb34"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># use column transformer to insert different transformers for each column</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.compose <span class="im">import</span> ColumnTransformer</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>ct <span class="op">=</span> ColumnTransformer([</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>                        (<span class="st">&quot;encoding&quot;</span>,OrdinalEncoder(),categorical_cols),</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>                        (<span class="st">&quot;standard_poly&quot;</span>,StandardScaler(), numerical_cols)])</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>X_encoded <span class="op">=</span> pd.DataFrame(ct.fit_transform(X, t), columns<span class="op">=</span>all_cols)</span></code></pre></div>
</div>
<div class="cell markdown">
<p>Here we did normalization for numeric values and encoding for
categorical values</p>
</div>
<div class="cell code" data-execution_count="58"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-08-09T10:49:17.487761Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-08-09T10:49:17.487407Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-08-09T10:51:22.613633Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-08-09T10:51:22.612468Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-08-09T10:49:17.487735Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb35"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># find best subset of features on this dataset with SGDRegressor</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.feature_selection <span class="im">import</span> RFECV</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> RepeatedKFold</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>selector_sgd <span class="op">=</span> RFECV(SGDRegressor(random_state<span class="op">=</span><span class="dv">1</span>), cv<span class="op">=</span>RepeatedKFold(n_splits<span class="op">=</span><span class="dv">5</span>, n_repeats<span class="op">=</span><span class="dv">10</span>, random_state<span class="op">=</span><span class="dv">1</span>)).fit(X_encoded, t)</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>X_selected_features_sgd <span class="op">=</span> X_encoded.loc[:, selector_sgd.support_]</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>display(X_selected_features_sgd)</span></code></pre></div>
<div class="output display_data">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>MSZoning</th>
      <th>LotFrontage</th>
      <th>Street</th>
      <th>Utilities</th>
      <th>LandSlope</th>
      <th>Neighborhood</th>
      <th>Condition2</th>
      <th>BldgType</th>
      <th>YearRemodAdd</th>
      <th>RoofStyle</th>
      <th>...</th>
      <th>BsmtFullBath</th>
      <th>HalfBath</th>
      <th>BedroomAbvGr</th>
      <th>KitchenAbvGr</th>
      <th>TotRmsAbvGrd</th>
      <th>FireplaceQu</th>
      <th>GarageType</th>
      <th>GarageCars</th>
      <th>GarageCond</th>
      <th>OpenPorchSF</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>3.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>...</td>
      <td>0.651479</td>
      <td>0.878668</td>
      <td>0.514104</td>
      <td>0.575425</td>
      <td>-0.459303</td>
      <td>0.370333</td>
      <td>1.107810</td>
      <td>0.163779</td>
      <td>-0.951226</td>
      <td>0.351000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>...</td>
      <td>-0.071836</td>
      <td>-0.429577</td>
      <td>-0.570750</td>
      <td>1.171992</td>
      <td>0.466465</td>
      <td>-0.482512</td>
      <td>-0.819964</td>
      <td>0.163779</td>
      <td>0.600495</td>
      <td>-0.060731</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>...</td>
      <td>0.651479</td>
      <td>0.830215</td>
      <td>0.325915</td>
      <td>0.092907</td>
      <td>-0.313369</td>
      <td>0.515013</td>
      <td>1.107810</td>
      <td>0.163779</td>
      <td>0.600495</td>
      <td>0.631726</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>...</td>
      <td>0.651479</td>
      <td>-0.720298</td>
      <td>-0.570750</td>
      <td>-0.499274</td>
      <td>-0.687324</td>
      <td>0.383659</td>
      <td>1.107810</td>
      <td>0.163779</td>
      <td>0.600495</td>
      <td>0.790804</td>
    </tr>
    <tr>
      <th>4</th>
      <td>3.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>...</td>
      <td>1.374795</td>
      <td>0.733308</td>
      <td>1.366489</td>
      <td>0.463568</td>
      <td>0.199680</td>
      <td>1.299326</td>
      <td>1.107810</td>
      <td>1.390023</td>
      <td>0.600495</td>
      <td>1.698485</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1455</th>
      <td>3.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>...</td>
      <td>-0.071836</td>
      <td>0.733308</td>
      <td>-0.570750</td>
      <td>-0.973018</td>
      <td>-0.238122</td>
      <td>0.250402</td>
      <td>-0.819964</td>
      <td>0.163779</td>
      <td>0.600495</td>
      <td>-0.060731</td>
    </tr>
    <tr>
      <th>1456</th>
      <td>3.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>3.0</td>
      <td>...</td>
      <td>-0.071836</td>
      <td>0.151865</td>
      <td>0.087911</td>
      <td>0.759659</td>
      <td>1.104925</td>
      <td>1.061367</td>
      <td>1.107810</td>
      <td>0.163779</td>
      <td>2.152216</td>
      <td>0.126420</td>
    </tr>
    <tr>
      <th>1457</th>
      <td>3.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.651479</td>
      <td>1.024029</td>
      <td>-0.570750</td>
      <td>-0.369871</td>
      <td>0.215641</td>
      <td>1.569647</td>
      <td>-0.819964</td>
      <td>1.390023</td>
      <td>2.152216</td>
      <td>-1.033914</td>
    </tr>
    <tr>
      <th>1458</th>
      <td>3.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>3.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>...</td>
      <td>-0.795151</td>
      <td>0.539493</td>
      <td>-0.570750</td>
      <td>-0.865548</td>
      <td>0.046905</td>
      <td>-0.832788</td>
      <td>1.107810</td>
      <td>-1.062465</td>
      <td>-0.951226</td>
      <td>-1.090059</td>
    </tr>
    <tr>
      <th>1459</th>
      <td>3.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>...</td>
      <td>-0.795151</td>
      <td>-0.962566</td>
      <td>-0.570750</td>
      <td>0.847389</td>
      <td>0.452784</td>
      <td>-0.493934</td>
      <td>1.107810</td>
      <td>0.163779</td>
      <td>-0.951226</td>
      <td>-0.921624</td>
    </tr>
  </tbody>
</table>
<p>1460 rows × 32 columns</p>
</div>
</div>
</div>
<div class="cell markdown">
<p>Here we wanted to see which features will give us the best score for
Sgd reggression</p>
</div>
<div class="cell code" data-execution_count="59"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-08-09T10:51:22.615495Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-08-09T10:51:22.615085Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-08-09T10:51:57.621423Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-08-09T10:51:57.620105Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-08-09T10:51:22.615459Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb36"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># find best subset of features on this dataset with LinearRegression</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>selector_lr <span class="op">=</span> RFECV(LinearRegression(), cv<span class="op">=</span>RepeatedKFold(n_splits<span class="op">=</span><span class="dv">5</span>, n_repeats<span class="op">=</span><span class="dv">10</span>, random_state<span class="op">=</span><span class="dv">42</span>)).fit(X_encoded, t)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>X_selected_features_lr <span class="op">=</span> X_encoded.loc[:, selector_lr.support_]</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>display(X_selected_features_lr)</span></code></pre></div>
<div class="output display_data">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>MSZoning</th>
      <th>LotFrontage</th>
      <th>LotArea</th>
      <th>Street</th>
      <th>LotShape</th>
      <th>Utilities</th>
      <th>Neighborhood</th>
      <th>Condition1</th>
      <th>Condition2</th>
      <th>BldgType</th>
      <th>...</th>
      <th>GarageType</th>
      <th>GarageYrBlt</th>
      <th>GarageCars</th>
      <th>GarageArea</th>
      <th>GarageQual</th>
      <th>GarageCond</th>
      <th>PavedDrive</th>
      <th>WoodDeckSF</th>
      <th>EnclosedPorch</th>
      <th>SaleCondition</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>3.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>...</td>
      <td>1.107810</td>
      <td>0.789741</td>
      <td>0.163779</td>
      <td>-0.211454</td>
      <td>0.912210</td>
      <td>-0.951226</td>
      <td>1.017598</td>
      <td>0.311725</td>
      <td>-0.752176</td>
      <td>-0.270208</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>...</td>
      <td>-0.819964</td>
      <td>0.789741</td>
      <td>0.163779</td>
      <td>-0.211454</td>
      <td>-0.318683</td>
      <td>0.600495</td>
      <td>-0.107927</td>
      <td>0.311725</td>
      <td>1.626195</td>
      <td>-0.270208</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>...</td>
      <td>1.107810</td>
      <td>0.789741</td>
      <td>0.163779</td>
      <td>-0.211454</td>
      <td>-0.318683</td>
      <td>0.600495</td>
      <td>0.934226</td>
      <td>0.311725</td>
      <td>-0.752176</td>
      <td>-0.270208</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>...</td>
      <td>1.107810</td>
      <td>-1.026041</td>
      <td>0.163779</td>
      <td>-0.211454</td>
      <td>0.296763</td>
      <td>0.600495</td>
      <td>0.809167</td>
      <td>1.650307</td>
      <td>-0.752176</td>
      <td>-0.270208</td>
    </tr>
    <tr>
      <th>4</th>
      <td>3.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>...</td>
      <td>1.107810</td>
      <td>0.789741</td>
      <td>1.390023</td>
      <td>-0.211454</td>
      <td>1.527656</td>
      <td>0.600495</td>
      <td>0.892540</td>
      <td>1.650307</td>
      <td>0.780197</td>
      <td>-0.270208</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1455</th>
      <td>3.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>...</td>
      <td>-0.819964</td>
      <td>0.789741</td>
      <td>0.163779</td>
      <td>-0.211454</td>
      <td>0.296763</td>
      <td>0.600495</td>
      <td>0.850854</td>
      <td>0.311725</td>
      <td>-0.752176</td>
      <td>-0.270208</td>
    </tr>
    <tr>
      <th>1456</th>
      <td>3.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>...</td>
      <td>1.107810</td>
      <td>0.789741</td>
      <td>0.163779</td>
      <td>-0.211454</td>
      <td>0.296763</td>
      <td>2.152216</td>
      <td>-0.024555</td>
      <td>0.311725</td>
      <td>2.033231</td>
      <td>-0.270208</td>
    </tr>
    <tr>
      <th>1457</th>
      <td>3.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>...</td>
      <td>-0.819964</td>
      <td>0.789741</td>
      <td>1.390023</td>
      <td>-0.211454</td>
      <td>1.527656</td>
      <td>2.152216</td>
      <td>-1.566941</td>
      <td>-1.026858</td>
      <td>-0.752176</td>
      <td>-0.270208</td>
    </tr>
    <tr>
      <th>1458</th>
      <td>3.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>3.0</td>
      <td>...</td>
      <td>1.107810</td>
      <td>-1.026041</td>
      <td>-1.062465</td>
      <td>-0.211454</td>
      <td>-0.934130</td>
      <td>-0.951226</td>
      <td>-1.191766</td>
      <td>-1.026858</td>
      <td>2.168910</td>
      <td>-0.270208</td>
    </tr>
    <tr>
      <th>1459</th>
      <td>3.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>...</td>
      <td>1.107810</td>
      <td>-1.026041</td>
      <td>0.163779</td>
      <td>-0.211454</td>
      <td>-0.318683</td>
      <td>-0.951226</td>
      <td>-0.566474</td>
      <td>-1.026858</td>
      <td>5.121921</td>
      <td>-0.270208</td>
    </tr>
  </tbody>
</table>
<p>1460 rows × 45 columns</p>
</div>
</div>
</div>
<div class="cell markdown">
<p>Here we wanted to see which features will give us the best score for
linear reggression</p>
</div>
<div class="cell code" data-execution_count="60"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-08-09T10:51:57.624598Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-08-09T10:51:57.623525Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-08-09T10:51:57.643230Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-08-09T10:51:57.641753Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-08-09T10:51:57.624516Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb37"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co">&#39;&#39;&#39;</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="co">print(&#39;SGDRegressor&#39;)</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="co">evaluate_model(X_selected_features_sgd, selector_sgd)</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="co">print(&#39;LinearRegression&#39;)</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a><span class="co">evaluate_model(X_selected_features_lr, selector_lr)</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a><span class="co">&#39;&#39;&#39;</span></span></code></pre></div>
<div class="output execute_result" data-execution_count="60">
<pre><code>&quot;\nprint(&#39;SGDRegressor&#39;)\nevaluate_model(X_selected_features_sgd, selector_sgd)\n\nprint(&#39;LinearRegression&#39;)\nevaluate_model(X_selected_features_lr, selector_lr)\n&quot;</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="61"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-08-09T10:51:57.653257Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-08-09T10:51:57.648482Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-08-09T10:52:17.311794Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-08-09T10:52:17.310424Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-08-09T10:51:57.653181Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb39"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># train with grid search and get best parameters</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> GridSearchCV</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>hyper_parameters <span class="op">=</span> {<span class="st">&#39;penalty&#39;</span>: (<span class="st">&#39;l2&#39;</span>, <span class="st">&#39;l1&#39;</span>, <span class="st">&#39;elasticnet&#39;</span>), <span class="st">&#39;alpha&#39;</span>: [<span class="fl">0.0001</span>, <span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="fl">0.1</span>], <span class="st">&#39;eta0&#39;</span>: [<span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="fl">0.1</span>, <span class="fl">0.5</span>]}</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>gs_model <span class="op">=</span> GridSearchCV(SGDRegressor(random_state<span class="op">=</span><span class="dv">1</span>), hyper_parameters).fit(X_selected_features_sgd, t)</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;best params&#39;</span>, gs_model.best_params_)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>best params {&#39;alpha&#39;: 0.1, &#39;eta0&#39;: 0.01, &#39;penalty&#39;: &#39;elasticnet&#39;}
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="62"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-08-09T10:52:17.319718Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-08-09T10:52:17.313603Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-08-09T10:52:21.655651Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-08-09T10:52:21.654457Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-08-09T10:52:17.319657Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb41"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># train with random search and get best parameters</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> RandomizedSearchCV</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> uniform</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">1</span>)</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>distributions <span class="op">=</span> <span class="bu">dict</span>(alpha<span class="op">=</span>uniform(loc<span class="op">=</span><span class="dv">0</span>, scale<span class="op">=</span><span class="dv">1</span>), penalty<span class="op">=</span>[<span class="st">&#39;l2&#39;</span>, <span class="st">&#39;l1&#39;</span>, <span class="st">&#39;elasticnet&#39;</span>], eta0<span class="op">=</span>[<span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="fl">0.1</span>, <span class="fl">0.5</span>])</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>rs_model <span class="op">=</span> RandomizedSearchCV(SGDRegressor(), distributions, random_state<span class="op">=</span><span class="dv">1</span>).fit(X_selected_features_sgd, t)</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;best params&#39;</span>, rs_model.best_params_)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>best params {&#39;alpha&#39;: 0.14675589081711304, &#39;eta0&#39;: 0.001, &#39;penalty&#39;: &#39;l1&#39;}
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="63"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-08-09T10:52:21.664731Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-08-09T10:52:21.661385Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-08-09T10:52:21.675153Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-08-09T10:52:21.673998Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-08-09T10:52:21.664673Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb43"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co">&#39;&#39;&#39;</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="co">print(&#39;GridSearchCV&#39;)</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="co">evaluate_model(X_selected_features_sgd, gs_model)</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a><span class="co">print(&#39;RandomizedSearchCV&#39;)</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a><span class="co">evaluate_model(X_selected_features_sgd, rs_model)</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a><span class="co">&#39;&#39;&#39;</span></span></code></pre></div>
<div class="output execute_result" data-execution_count="63">
<pre><code>&quot;\nprint(&#39;GridSearchCV&#39;)\nevaluate_model(X_selected_features_sgd, gs_model)\n\nprint(&#39;RandomizedSearchCV&#39;)\nevaluate_model(X_selected_features_sgd, rs_model)\n&quot;</code></pre>
</div>
</div>
<div class="cell markdown">
<p>########Test Prediction########</p>
</div>
<div class="cell code" data-execution_count="64"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-08-09T10:52:21.677892Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-08-09T10:52:21.677090Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-08-09T10:52:21.733545Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-08-09T10:52:21.732521Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-08-09T10:52:21.677850Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb45"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>hp_test_df <span class="op">=</span> pd.read_csv(<span class="st">&quot;/kaggle/input/house-prices-advanced-regression-techniques/test.csv&quot;</span>)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>hp_test_df.reset_index(drop<span class="op">=</span><span class="va">True</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>display(hp_test_df)</span></code></pre></div>
<div class="output display_data">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Id</th>
      <th>MSSubClass</th>
      <th>MSZoning</th>
      <th>LotFrontage</th>
      <th>LotArea</th>
      <th>Street</th>
      <th>Alley</th>
      <th>LotShape</th>
      <th>LandContour</th>
      <th>Utilities</th>
      <th>...</th>
      <th>ScreenPorch</th>
      <th>PoolArea</th>
      <th>PoolQC</th>
      <th>Fence</th>
      <th>MiscFeature</th>
      <th>MiscVal</th>
      <th>MoSold</th>
      <th>YrSold</th>
      <th>SaleType</th>
      <th>SaleCondition</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1461</td>
      <td>20</td>
      <td>RH</td>
      <td>80.0</td>
      <td>11622</td>
      <td>Pave</td>
      <td>NaN</td>
      <td>Reg</td>
      <td>Lvl</td>
      <td>AllPub</td>
      <td>...</td>
      <td>120</td>
      <td>0</td>
      <td>NaN</td>
      <td>MnPrv</td>
      <td>NaN</td>
      <td>0</td>
      <td>6</td>
      <td>2010</td>
      <td>WD</td>
      <td>Normal</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1462</td>
      <td>20</td>
      <td>RL</td>
      <td>81.0</td>
      <td>14267</td>
      <td>Pave</td>
      <td>NaN</td>
      <td>IR1</td>
      <td>Lvl</td>
      <td>AllPub</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Gar2</td>
      <td>12500</td>
      <td>6</td>
      <td>2010</td>
      <td>WD</td>
      <td>Normal</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1463</td>
      <td>60</td>
      <td>RL</td>
      <td>74.0</td>
      <td>13830</td>
      <td>Pave</td>
      <td>NaN</td>
      <td>IR1</td>
      <td>Lvl</td>
      <td>AllPub</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
      <td>MnPrv</td>
      <td>NaN</td>
      <td>0</td>
      <td>3</td>
      <td>2010</td>
      <td>WD</td>
      <td>Normal</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1464</td>
      <td>60</td>
      <td>RL</td>
      <td>78.0</td>
      <td>9978</td>
      <td>Pave</td>
      <td>NaN</td>
      <td>IR1</td>
      <td>Lvl</td>
      <td>AllPub</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>6</td>
      <td>2010</td>
      <td>WD</td>
      <td>Normal</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1465</td>
      <td>120</td>
      <td>RL</td>
      <td>43.0</td>
      <td>5005</td>
      <td>Pave</td>
      <td>NaN</td>
      <td>IR1</td>
      <td>HLS</td>
      <td>AllPub</td>
      <td>...</td>
      <td>144</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>1</td>
      <td>2010</td>
      <td>WD</td>
      <td>Normal</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1454</th>
      <td>2915</td>
      <td>160</td>
      <td>RM</td>
      <td>21.0</td>
      <td>1936</td>
      <td>Pave</td>
      <td>NaN</td>
      <td>Reg</td>
      <td>Lvl</td>
      <td>AllPub</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>6</td>
      <td>2006</td>
      <td>WD</td>
      <td>Normal</td>
    </tr>
    <tr>
      <th>1455</th>
      <td>2916</td>
      <td>160</td>
      <td>RM</td>
      <td>21.0</td>
      <td>1894</td>
      <td>Pave</td>
      <td>NaN</td>
      <td>Reg</td>
      <td>Lvl</td>
      <td>AllPub</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>4</td>
      <td>2006</td>
      <td>WD</td>
      <td>Abnorml</td>
    </tr>
    <tr>
      <th>1456</th>
      <td>2917</td>
      <td>20</td>
      <td>RL</td>
      <td>160.0</td>
      <td>20000</td>
      <td>Pave</td>
      <td>NaN</td>
      <td>Reg</td>
      <td>Lvl</td>
      <td>AllPub</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>9</td>
      <td>2006</td>
      <td>WD</td>
      <td>Abnorml</td>
    </tr>
    <tr>
      <th>1457</th>
      <td>2918</td>
      <td>85</td>
      <td>RL</td>
      <td>62.0</td>
      <td>10441</td>
      <td>Pave</td>
      <td>NaN</td>
      <td>Reg</td>
      <td>Lvl</td>
      <td>AllPub</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
      <td>MnPrv</td>
      <td>Shed</td>
      <td>700</td>
      <td>7</td>
      <td>2006</td>
      <td>WD</td>
      <td>Normal</td>
    </tr>
    <tr>
      <th>1458</th>
      <td>2919</td>
      <td>60</td>
      <td>RL</td>
      <td>74.0</td>
      <td>9627</td>
      <td>Pave</td>
      <td>NaN</td>
      <td>Reg</td>
      <td>Lvl</td>
      <td>AllPub</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>11</td>
      <td>2006</td>
      <td>WD</td>
      <td>Normal</td>
    </tr>
  </tbody>
</table>
<p>1459 rows × 80 columns</p>
</div>
</div>
</div>
<div class="cell code" data-execution_count="65"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-08-09T10:52:21.735738Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-08-09T10:52:21.734764Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-08-09T10:52:21.751015Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-08-09T10:52:21.749735Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-08-09T10:52:21.735695Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb46"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>hp_test_df_ch_drop <span class="op">=</span> hp_test_df.copy()</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop these features from your dataframe</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>hp_test_df_ch_drop.drop(columns<span class="op">=</span>columns_to_drop, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>hp_test_df_ch_drop <span class="op">=</span> hp_test_df_ch_drop.drop(low_corr_features, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>hp_test_df_ch_drop.drop(columns<span class="op">=</span>[<span class="st">&#39;Id&#39;</span>], inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Now df contains only the features that have at least 20% correlation with the target variable</span></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(columns_to_drop)</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(low_corr_features)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Index([&#39;Alley&#39;, &#39;PoolQC&#39;, &#39;Fence&#39;, &#39;MiscFeature&#39;], dtype=&#39;object&#39;)
[&#39;MSSubClass&#39;, &#39;OverallCond&#39;, &#39;BsmtFinSF2&#39;, &#39;LowQualFinSF&#39;, &#39;BsmtHalfBath&#39;, &#39;3SsnPorch&#39;, &#39;PoolArea&#39;, &#39;MiscVal&#39;, &#39;MoSold&#39;, &#39;YrSold&#39;]
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="66"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-08-09T10:52:21.752897Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-08-09T10:52:21.752577Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-08-09T10:52:21.816831Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-08-09T10:52:21.815773Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-08-09T10:52:21.752868Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb48"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> column <span class="kw">in</span> hp_test_df_ch_drop.columns:</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> hp_test_df_ch_drop[column].dtype <span class="op">==</span> <span class="st">&quot;float64&quot;</span> <span class="kw">or</span> hp_test_df_ch_drop[column].dtype <span class="op">==</span> <span class="st">&quot;int64&quot;</span>:</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>        hp_test_df_ch_drop[column].fillna(hp_test_df_ch_drop[column].mean(), inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>        hp_test_df_ch_drop[column].fillna(hp_test_df_ch_drop[column].mode()[<span class="dv">0</span>], inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>hp_test_df_ch_drop.head()</span></code></pre></div>
<div class="output stream stderr">
<pre><code>/tmp/ipykernel_434/1053076993.py:6: FutureWarning:

A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.



/tmp/ipykernel_434/1053076993.py:3: FutureWarning:

A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.



</code></pre>
</div>
<div class="output execute_result" data-execution_count="66">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>MSZoning</th>
      <th>LotFrontage</th>
      <th>LotArea</th>
      <th>Street</th>
      <th>LotShape</th>
      <th>LandContour</th>
      <th>Utilities</th>
      <th>LotConfig</th>
      <th>LandSlope</th>
      <th>Neighborhood</th>
      <th>...</th>
      <th>GarageArea</th>
      <th>GarageQual</th>
      <th>GarageCond</th>
      <th>PavedDrive</th>
      <th>WoodDeckSF</th>
      <th>OpenPorchSF</th>
      <th>EnclosedPorch</th>
      <th>ScreenPorch</th>
      <th>SaleType</th>
      <th>SaleCondition</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>RH</td>
      <td>80.0</td>
      <td>11622</td>
      <td>Pave</td>
      <td>Reg</td>
      <td>Lvl</td>
      <td>AllPub</td>
      <td>Inside</td>
      <td>Gtl</td>
      <td>NAmes</td>
      <td>...</td>
      <td>730.0</td>
      <td>TA</td>
      <td>TA</td>
      <td>Y</td>
      <td>140</td>
      <td>0</td>
      <td>0</td>
      <td>120</td>
      <td>WD</td>
      <td>Normal</td>
    </tr>
    <tr>
      <th>1</th>
      <td>RL</td>
      <td>81.0</td>
      <td>14267</td>
      <td>Pave</td>
      <td>IR1</td>
      <td>Lvl</td>
      <td>AllPub</td>
      <td>Corner</td>
      <td>Gtl</td>
      <td>NAmes</td>
      <td>...</td>
      <td>312.0</td>
      <td>TA</td>
      <td>TA</td>
      <td>Y</td>
      <td>393</td>
      <td>36</td>
      <td>0</td>
      <td>0</td>
      <td>WD</td>
      <td>Normal</td>
    </tr>
    <tr>
      <th>2</th>
      <td>RL</td>
      <td>74.0</td>
      <td>13830</td>
      <td>Pave</td>
      <td>IR1</td>
      <td>Lvl</td>
      <td>AllPub</td>
      <td>Inside</td>
      <td>Gtl</td>
      <td>Gilbert</td>
      <td>...</td>
      <td>482.0</td>
      <td>TA</td>
      <td>TA</td>
      <td>Y</td>
      <td>212</td>
      <td>34</td>
      <td>0</td>
      <td>0</td>
      <td>WD</td>
      <td>Normal</td>
    </tr>
    <tr>
      <th>3</th>
      <td>RL</td>
      <td>78.0</td>
      <td>9978</td>
      <td>Pave</td>
      <td>IR1</td>
      <td>Lvl</td>
      <td>AllPub</td>
      <td>Inside</td>
      <td>Gtl</td>
      <td>Gilbert</td>
      <td>...</td>
      <td>470.0</td>
      <td>TA</td>
      <td>TA</td>
      <td>Y</td>
      <td>360</td>
      <td>36</td>
      <td>0</td>
      <td>0</td>
      <td>WD</td>
      <td>Normal</td>
    </tr>
    <tr>
      <th>4</th>
      <td>RL</td>
      <td>43.0</td>
      <td>5005</td>
      <td>Pave</td>
      <td>IR1</td>
      <td>HLS</td>
      <td>AllPub</td>
      <td>Inside</td>
      <td>Gtl</td>
      <td>StoneBr</td>
      <td>...</td>
      <td>506.0</td>
      <td>TA</td>
      <td>TA</td>
      <td>Y</td>
      <td>0</td>
      <td>82</td>
      <td>0</td>
      <td>144</td>
      <td>WD</td>
      <td>Normal</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 65 columns</p>
</div>
</div>
</div>
<div class="cell code" data-execution_count="67"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-08-09T10:52:21.818946Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-08-09T10:52:21.818267Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-08-09T10:52:21.830386Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-08-09T10:52:21.829049Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-08-09T10:52:21.818912Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb50"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>hp_test_df_ch_drop.isnull().<span class="bu">sum</span>().<span class="bu">sum</span>()</span></code></pre></div>
<div class="output execute_result" data-execution_count="67">
<pre><code>0</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="68"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-08-09T10:52:21.832350Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-08-09T10:52:21.831921Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-08-09T10:52:21.851725Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-08-09T10:52:21.850192Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-08-09T10:52:21.832317Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb52"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>hp_test_df_ch_drop.info()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 1459 entries, 0 to 1458
Data columns (total 65 columns):
 #   Column         Non-Null Count  Dtype  
---  ------         --------------  -----  
 0   MSZoning       1459 non-null   object 
 1   LotFrontage    1459 non-null   float64
 2   LotArea        1459 non-null   int64  
 3   Street         1459 non-null   object 
 4   LotShape       1459 non-null   object 
 5   LandContour    1459 non-null   object 
 6   Utilities      1459 non-null   object 
 7   LotConfig      1459 non-null   object 
 8   LandSlope      1459 non-null   object 
 9   Neighborhood   1459 non-null   object 
 10  Condition1     1459 non-null   object 
 11  Condition2     1459 non-null   object 
 12  BldgType       1459 non-null   object 
 13  HouseStyle     1459 non-null   object 
 14  OverallQual    1459 non-null   int64  
 15  YearBuilt      1459 non-null   int64  
 16  YearRemodAdd   1459 non-null   int64  
 17  RoofStyle      1459 non-null   object 
 18  RoofMatl       1459 non-null   object 
 19  Exterior1st    1459 non-null   object 
 20  Exterior2nd    1459 non-null   object 
 21  MasVnrType     1459 non-null   object 
 22  MasVnrArea     1459 non-null   float64
 23  ExterQual      1459 non-null   object 
 24  ExterCond      1459 non-null   object 
 25  Foundation     1459 non-null   object 
 26  BsmtQual       1459 non-null   object 
 27  BsmtCond       1459 non-null   object 
 28  BsmtExposure   1459 non-null   object 
 29  BsmtFinType1   1459 non-null   object 
 30  BsmtFinSF1     1459 non-null   float64
 31  BsmtFinType2   1459 non-null   object 
 32  BsmtUnfSF      1459 non-null   float64
 33  TotalBsmtSF    1459 non-null   float64
 34  Heating        1459 non-null   object 
 35  HeatingQC      1459 non-null   object 
 36  CentralAir     1459 non-null   object 
 37  Electrical     1459 non-null   object 
 38  1stFlrSF       1459 non-null   int64  
 39  2ndFlrSF       1459 non-null   int64  
 40  GrLivArea      1459 non-null   int64  
 41  BsmtFullBath   1459 non-null   float64
 42  FullBath       1459 non-null   int64  
 43  HalfBath       1459 non-null   int64  
 44  BedroomAbvGr   1459 non-null   int64  
 45  KitchenAbvGr   1459 non-null   int64  
 46  KitchenQual    1459 non-null   object 
 47  TotRmsAbvGrd   1459 non-null   int64  
 48  Functional     1459 non-null   object 
 49  Fireplaces     1459 non-null   int64  
 50  FireplaceQu    1459 non-null   object 
 51  GarageType     1459 non-null   object 
 52  GarageYrBlt    1459 non-null   float64
 53  GarageFinish   1459 non-null   object 
 54  GarageCars     1459 non-null   float64
 55  GarageArea     1459 non-null   float64
 56  GarageQual     1459 non-null   object 
 57  GarageCond     1459 non-null   object 
 58  PavedDrive     1459 non-null   object 
 59  WoodDeckSF     1459 non-null   int64  
 60  OpenPorchSF    1459 non-null   int64  
 61  EnclosedPorch  1459 non-null   int64  
 62  ScreenPorch    1459 non-null   int64  
 63  SaleType       1459 non-null   object 
 64  SaleCondition  1459 non-null   object 
dtypes: float64(9), int64(17), object(39)
memory usage: 741.0+ KB
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="69"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-08-09T10:52:21.853708Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-08-09T10:52:21.853286Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-08-09T10:52:21.902515Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-08-09T10:52:21.901389Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-08-09T10:52:21.853677Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb54"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>numerical_cols <span class="op">=</span> hp_test_df_ch_drop.select_dtypes(include<span class="op">=</span>[<span class="st">&#39;int64&#39;</span>, <span class="st">&#39;float64&#39;</span>]).columns</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>categorical_cols <span class="op">=</span> hp_test_df_ch_drop.select_dtypes(include<span class="op">=</span>[<span class="st">&#39;object&#39;</span>, <span class="st">&#39;bool&#39;</span>]).columns</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>all_cols <span class="op">=</span> np.array(hp_test_df_ch_drop.columns)</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>ct_test <span class="op">=</span> ColumnTransformer([</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>                        (<span class="st">&quot;encoding&quot;</span>,OrdinalEncoder(),categorical_cols),</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>                        (<span class="st">&quot;standard_poly&quot;</span>,StandardScaler(), numerical_cols)])</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>test_encoded <span class="op">=</span> pd.DataFrame(ct_test.fit_transform(hp_test_df_ch_drop), columns<span class="op">=</span>all_cols)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="70"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-08-09T10:52:21.904199Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-08-09T10:52:21.903830Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-08-09T10:52:51.022309Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-08-09T10:52:51.021049Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-08-09T10:52:21.904161Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb55"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> RFECV(LinearRegression(), cv<span class="op">=</span>RepeatedKFold(n_splits<span class="op">=</span><span class="dv">5</span>, n_repeats<span class="op">=</span><span class="dv">10</span>, random_state<span class="op">=</span><span class="dv">42</span>)).fit(X_encoded, t)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="71"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-08-09T10:52:51.025319Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-08-09T10:52:51.024361Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-08-09T10:52:51.082027Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-08-09T10:52:51.080684Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-08-09T10:52:51.025255Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb56"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>submission <span class="op">=</span> pd.DataFrame({</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Id&#39;</span>: hp_test_df[<span class="st">&#39;Id&#39;</span>],</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;SalePrice&#39;</span>: model.predict(test_encoded)</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>submission.to_csv(<span class="st">&#39;submission.csv&#39;</span>, index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>submission</span></code></pre></div>
<div class="output execute_result" data-execution_count="71">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Id</th>
      <th>SalePrice</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1461</td>
      <td>111754.899535</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1462</td>
      <td>166622.975185</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1463</td>
      <td>174250.133356</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1464</td>
      <td>190476.594005</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1465</td>
      <td>178942.971633</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1454</th>
      <td>2915</td>
      <td>59003.563780</td>
    </tr>
    <tr>
      <th>1455</th>
      <td>2916</td>
      <td>58847.590232</td>
    </tr>
    <tr>
      <th>1456</th>
      <td>2917</td>
      <td>136140.336612</td>
    </tr>
    <tr>
      <th>1457</th>
      <td>2918</td>
      <td>115510.834397</td>
    </tr>
    <tr>
      <th>1458</th>
      <td>2919</td>
      <td>243321.452092</td>
    </tr>
  </tbody>
</table>
<p>1459 rows × 2 columns</p>
</div>
</div>
</div>
<div class="cell markdown">
<p><img
src="vertopal_4fa37495b4184bc2901899a734acb6ec/59ac747c-d85a-4aec-9a2f-1b269758a7fb.png"
alt="image.png" /></p>
</div>
<div class="cell markdown">
<p><strong>Conclusions</strong></p>
<blockquote>
<p>First, we filled empty values with mean and mode filling types. than,
we dropped unrelevant features by low correlation or more than 60% empty
values. we used to models, SGD reggression and Linear regrresion. we
came to a conclusion that the liniear regrresion will provide the lowest
score so we used that model on our test. weve got good results, the best
of them is 0.17812. in our notebook you can see graphs, data and
markdowens after each code block. every submmision we tries diffrent
things as changing the bounds for low correlation or empty values, we
tried diffrent values of k's for Kfold, we tried a diffrent models and
etc...</p>
</blockquote>
<ul>
<li>We didnt add a lot of graphs because we handled the very big amount
of features in generic way</li>
</ul>
</div>
<section id="exercise-4" class="cell markdown">
<h1>exercise 4</h1>
</section>
<div class="cell markdown">
<p>Ariel Yogev 207917501 Guy Ben Moshe 318363397</p>
</div>
<section id="tldr" class="cell markdown">
<h3>TL;DR</h3>
<p>In this task, our goal is to find the best model for predicting house
prices. After analyzing and preparing the data earlier, we'll now focus
on optimizing the models we've learned about. We'll test different
algorithms like LWLR, KNN, Decision Trees, and SVM to see which one
gives the best results. We'll also use PCA to reduce the number of
features and create graphs to evaluate accuracy. Finally, we'll use a
VotingClassifier to combine the models and determine which combination
works best for our predictions.</p>
</section>
<section id="lwlr" class="cell markdown">
<h1>LWLR</h1>
</section>
<div class="cell code" data-execution_count="72"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-08-09T10:52:51.086718Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-08-09T10:52:51.084760Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-08-09T10:52:52.165999Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-08-09T10:52:52.164410Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-08-09T10:52:51.086668Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb57"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>git clone https:<span class="op">//</span>github.com<span class="op">/</span>qiaochen<span class="op">/</span>CourseExercises</span></code></pre></div>
<div class="output stream stdout">
<pre><code>fatal: destination path &#39;CourseExercises&#39; already exists and is not an empty directory.
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="73"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-08-09T10:52:52.168313Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-08-09T10:52:52.167910Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-08-09T10:54:09.731422Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-08-09T10:54:09.730170Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-08-09T10:52:52.168281Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb59"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> CourseExercises.lwlr <span class="im">import</span> LWLR</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> make_scorer, accuracy_score</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a><span class="co"># get best k for lwlr (show the calculation of this sell)</span></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>hyper_parameters <span class="op">=</span> {<span class="st">&#39;k&#39;</span>: <span class="bu">list</span>(<span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">10</span>))}</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>arr_X<span class="op">=</span> np.asarray(X_selected_features_lr)</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>gs_lw_model_backward <span class="op">=</span> GridSearchCV(LWLR(k<span class="op">=</span><span class="dv">1</span>), hyper_parameters, </span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>                           scoring<span class="op">=</span><span class="st">&#39;r2&#39;</span>).fit(arr_X, t)</span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;R2 score for regression:&#39;</span>)</span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;gs_lw_model&#39;</span>, gs_lw_model_backward.best_score_)</span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;best params&#39;</span>, gs_lw_model_backward.best_params_)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>R2 score for regression:
gs_lw_model 0.85857727129336
best params {&#39;k&#39;: 9}
</code></pre>
</div>
</div>
<section id="knn-with-grid-search" class="cell markdown">
<h1>KNN with grid search</h1>
</section>
<div class="cell code" data-execution_count="74"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-08-09T10:54:09.734436Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-08-09T10:54:09.733127Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-08-09T10:54:10.896272Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-08-09T10:54:10.895060Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-08-09T10:54:09.734381Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb61"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># run KNN on the dataset and find best K by R2 and accuracy</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.neighbors <span class="im">import</span> KNeighborsRegressor</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>hyper_parameters_KNN <span class="op">=</span> {<span class="st">&#39;n_neighbors&#39;</span>: <span class="bu">list</span>(<span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">20</span>))}</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>gs_neigh_model_backward <span class="op">=</span> GridSearchCV(KNeighborsRegressor(</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>    n_neighbors<span class="op">=</span><span class="dv">5</span>, weights<span class="op">=</span><span class="st">&#39;distance&#39;</span>), </span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>    hyper_parameters_KNN).fit(X_selected_features_lr, t)</span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;R2 score for regression:&#39;</span>)</span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;gs_neigh_model&#39;</span>, gs_neigh_model_backward.best_score_)</span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;best params&#39;</span>, gs_neigh_model_backward.best_params_)</span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>R2 score for regression:
gs_neigh_model 0.777591545485763
best params {&#39;n_neighbors&#39;: 12}

</code></pre>
</div>
</div>
<section id="decision-trees" class="cell markdown">
<h1>Decision Trees</h1>
</section>
<div class="cell code" data-execution_count="75"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-08-09T10:54:10.898224Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-08-09T10:54:10.897837Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-08-09T10:54:47.386740Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-08-09T10:54:47.385308Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-08-09T10:54:10.898189Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb63"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.tree <span class="im">import</span> DecisionTreeRegressor</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Define hyperparameters for tuning</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>hyper_parameters <span class="op">=</span> {<span class="st">&#39;max_depth&#39;</span>: <span class="bu">list</span>(<span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">20</span>)),</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;min_samples_split&#39;</span>: [<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">20</span>],</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;min_samples_leaf&#39;</span>: [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">8</span>, <span class="dv">12</span>]}</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize and fit the GridSearchCV with DecisionTreeRegressor</span></span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>gs_tree_model <span class="op">=</span> GridSearchCV(DecisionTreeRegressor(random_state<span class="op">=</span><span class="dv">42</span>), </span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>                             hyper_parameters).fit(X_selected_features_lr, t)</span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the results</span></span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;R2 score for regression:&#39;</span>)</span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;gs_tree_model:&#39;</span>, gs_tree_model.best_score_)</span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;Best parameters:&#39;</span>, gs_tree_model.best_params_)</span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>R2 score for regression:
gs_tree_model: 0.7858174827520806
Best parameters: {&#39;max_depth&#39;: 8, &#39;min_samples_leaf&#39;: 1, &#39;min_samples_split&#39;: 10}

</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="76"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-08-09T10:54:47.393112Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-08-09T10:54:47.392715Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-08-09T10:54:47.948196Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-08-09T10:54:47.946892Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-08-09T10:54:47.393081Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb65"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn <span class="im">import</span> tree</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="co"># show the tree in graphics with graphviz</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> graphviz </span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>dot_data <span class="op">=</span> tree.export_graphviz(DecisionTreeRegressor(random_state<span class="op">=</span><span class="dv">42</span>, max_depth<span class="op">=</span><span class="dv">11</span>).fit(X_selected_features_lr, t),</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>               feature_names<span class="op">=</span>X_selected_features_lr.columns,</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>               class_names<span class="op">=</span>t.unique(), </span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>               filled<span class="op">=</span><span class="va">True</span>, </span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>               rounded<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>dot_data <span class="op">=</span> <span class="st">&#39;digraph Tree {</span><span class="ch">\n</span><span class="st">size=&quot;200,100&quot;;</span><span class="ch">\n</span><span class="st">&#39;</span> <span class="op">+</span> dot_data[dot_data.find(<span class="st">&#39;node&#39;</span>):]  <span class="co"># Correctly place the size attribute</span></span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a>graph <span class="op">=</span> graphviz.Source(dot_data) </span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a>graph</span></code></pre></div>
<div class="output execute_result" data-execution_count="76">
<p><img
src="vertopal_4fa37495b4184bc2901899a734acb6ec/e438b7647b11b6db032b58fa79eba6bda8e8e016.svg" /></p>
</div>
</div>
<section id="svm" class="cell markdown">
<h1>SVM</h1>
</section>
<div class="cell code" data-execution_count="77"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-08-09T10:54:47.950064Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-08-09T10:54:47.949666Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-08-09T10:55:09.009272Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-08-09T10:55:09.008144Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-08-09T10:54:47.950031Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb66"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> cross_val_score</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.svm <span class="im">import</span> SVR</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Define hyperparameters for tuning</span></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>hyper_parameters <span class="op">=</span> {<span class="st">&#39;kernel&#39;</span>: [<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;poly&#39;</span>, <span class="st">&#39;rbf&#39;</span>, <span class="st">&#39;sigmoid&#39;</span>],</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>              <span class="st">&#39;C&#39;</span>: [<span class="fl">0.1</span>, <span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">100</span>],</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>              <span class="st">&#39;gamma&#39;</span>: [<span class="st">&#39;scale&#39;</span>, <span class="st">&#39;auto&#39;</span>]}</span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize and fit the GridSearchCV with SVM (SVR)</span></span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>gs_svm_model_backward <span class="op">=</span> GridSearchCV(SVR(), hyper_parameters).fit(X_selected_features_lr, t)</span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the results</span></span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;R2 score for regression:&#39;</span>)</span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;gs_svm_model:&#39;</span>, gs_svm_model_backward.best_score_)</span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;Best parameters:&#39;</span>, gs_svm_model_backward.best_params_)</span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>R2 score for regression:
gs_svm_model: 0.8135134327549917
Best parameters: {&#39;C&#39;: 100, &#39;gamma&#39;: &#39;scale&#39;, &#39;kernel&#39;: &#39;linear&#39;}

</code></pre>
</div>
</div>
<div class="cell markdown">
<p><strong>Results Analysis:</strong></p>
<ul>
<li>LWLR (R² = 0.8586) achieved the highest R² score, indicating it
captured the relationship between the features and target variable most
effectively, likely due to its ability to model local variations in the
data.</li>
<li>SVM (R² = 0.8135) also performed well, showing its strength in
handling complex relationships with a well-chosen linear kernel.</li>
<li>Decision Trees (R² = 0.7858) provided a solid performance, balancing
complexity and interpretability but slightly underperformed compared to
LWLR and SVM.</li>
<li>KNN (R² = 0.7776) had the lowest R² score, possibly due to
sensitivity to the choice of neighbors and less effectiveness in
capturing the data's structure compared to the other models.</li>
</ul>
</div>
<div class="cell markdown">
<p><strong>Conclusion:</strong> LWLR achieved the best results with the
highest R² score, making it the most effective algorithm for this
specific regression task, likely due to its ability to adapt to local
patterns in the data.</p>
</div>
<section id="feature-compression-with-pca" class="cell markdown">
<h1>Feature Compression with PCA</h1>
</section>
<div class="cell code" data-execution_count="78"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-08-09T10:55:09.010833Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-08-09T10:55:09.010504Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-08-09T10:55:09.325319Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-08-09T10:55:09.323861Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-08-09T10:55:09.010805Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb68"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.decomposition <span class="im">import</span> PCA</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a><span class="co"># convert data points to 2dim with pca</span></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>num_of_columns <span class="op">=</span> <span class="bu">len</span>(X_selected_features_lr.columns)</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>pca <span class="op">=</span> PCA(n_components<span class="op">=</span>num_of_columns).fit(X_selected_features_lr)</span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.cumsum(pca.explained_variance_ratio_)</span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>plt.plot(<span class="bu">range</span>(<span class="dv">1</span>,<span class="bu">len</span>(y)<span class="op">+</span><span class="dv">1</span>),y)</span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>plt.axhline(y<span class="op">=</span><span class="fl">0.95</span>, color<span class="op">=</span><span class="st">&#39;r&#39;</span>, linestyle<span class="op">=</span><span class="st">&#39;-&#39;</span>) <span class="co"># aim to explain higher variance as possible 95%</span></span></code></pre></div>
<div class="output execute_result" data-execution_count="78">
<pre><code>&lt;matplotlib.lines.Line2D at 0x7c1aab2c3520&gt;</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_4fa37495b4184bc2901899a734acb6ec/c03394ba74c3bdea668371fd077e1762072e152b.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="79"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-08-09T10:55:09.327118Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-08-09T10:55:09.326771Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-08-09T11:01:46.396004Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-08-09T11:01:46.394692Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-08-09T10:55:09.327091Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb70"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define hyperparameters for tuning</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>param_grid <span class="op">=</span> {</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>              <span class="st">&#39;pca__n_components&#39;</span>: <span class="bu">list</span>(<span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">20</span>)),</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>              <span class="st">&#39;SVR__kernel&#39;</span>: [<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;rbf&#39;</span>, <span class="st">&#39;poly&#39;</span>],</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>              <span class="st">&#39;SVR__C&#39;</span>: [<span class="fl">0.1</span>, <span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">100</span>],</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>              <span class="st">&#39;SVR__gamma&#39;</span>: [<span class="st">&#39;scale&#39;</span>, <span class="st">&#39;auto&#39;</span>]}  <span class="co"># Adjust this according to your need, assuming &#39;k&#39; is a parameter in LWLR</span></span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Define a Pipeline including PCA and LWLR regressor</span></span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>pipeline <span class="op">=</span> Pipeline([</span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>    (<span class="st">&#39;pca&#39;</span>, PCA()),</span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a>    (<span class="st">&#39;SVR&#39;</span>, SVR())  <span class="co"># Initial &#39;k&#39; value, will be tuned</span></span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a>])</span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize and fit the GridSearchCV with the pipeline</span></span>
<span id="cb70-15"><a href="#cb70-15" aria-hidden="true" tabindex="-1"></a>gs_model <span class="op">=</span> GridSearchCV(estimator<span class="op">=</span>pipeline, param_grid<span class="op">=</span>param_grid, scoring<span class="op">=</span><span class="st">&#39;r2&#39;</span>)</span>
<span id="cb70-16"><a href="#cb70-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-17"><a href="#cb70-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Assuming arr_X_normalized and t are defined and hold your feature set and target variable</span></span>
<span id="cb70-18"><a href="#cb70-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the model</span></span>
<span id="cb70-19"><a href="#cb70-19" aria-hidden="true" tabindex="-1"></a>gs_model.fit(X_selected_features_lr, t)</span>
<span id="cb70-20"><a href="#cb70-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-21"><a href="#cb70-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the results</span></span>
<span id="cb70-22"><a href="#cb70-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;R2 score for regression:&#39;</span>)</span>
<span id="cb70-23"><a href="#cb70-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;gs_model:&#39;</span>, gs_model.best_score_)</span>
<span id="cb70-24"><a href="#cb70-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;Best parameters:&#39;</span>, gs_model.best_params_)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>R2 score for regression:
gs_model: 0.8065875155427076
Best parameters: {&#39;SVR__C&#39;: 100, &#39;SVR__gamma&#39;: &#39;auto&#39;, &#39;SVR__kernel&#39;: &#39;linear&#39;, &#39;pca__n_components&#39;: 19}
</code></pre>
</div>
</div>
<section id="ensembles" class="cell markdown">
<h1>Ensembles</h1>
</section>
<div class="cell markdown">
<ul>
<li>BaggingClassifier</li>
<li>AdaBoostClassifier</li>
<li>RandomForest</li>
</ul>
</div>
<div class="cell markdown">
<p>The best ensemble is the Bagging Regressor, and the best performing
version of Bagging Regressor is the one using SGD without
bootstrapping.</p>
</div>
<section id="bagging" class="cell markdown">
<h3>Bagging</h3>
</section>
<div class="cell markdown">
<ul>
<li>without boostrap</li>
</ul>
</div>
<div class="cell code" data-execution_count="80"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-08-09T11:01:46.397905Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-08-09T11:01:46.397535Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-08-09T11:01:46.649750Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-08-09T11:01:46.648391Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-08-09T11:01:46.397874Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb72"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get score with nfold bagging</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> BaggingRegressor</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>bag_SGD_model <span class="op">=</span> BaggingRegressor(estimator<span class="op">=</span>SGDRegressor(),</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>                                   n_estimators<span class="op">=</span><span class="dv">20</span>, random_state<span class="op">=</span><span class="dv">42</span>,</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>                                   bootstrap<span class="op">=</span><span class="va">False</span>).fit(X_selected_features_lr, t)</span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;Accuracy score for classification:&#39;</span>)</span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;bag_fold_model&#39;</span>, bag_SGD_model.score(X_selected_features_lr, t))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Accuracy score for classification:
bag_fold_model 0.8300302976887213
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="90"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-08-09T11:26:32.717112Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-08-09T11:26:32.716721Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-08-09T11:26:34.365960Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-08-09T11:26:34.364610Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-08-09T11:26:32.717081Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb74"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>evaluate_model(X_selected_features_lr, bag_SGD_model)</span></code></pre></div>
<div class="output stream stderr">
<pre><code>/opt/conda/lib/python3.10/site-packages/plotly/express/_core.py:2065: FutureWarning:

When grouping with a length-1 list-like, you will need to pass a length-1 tuple to get_group in a future version of pandas. Pass `(name,)` instead of `name` to silence this warning.

</code></pre>
</div>
<div class="output display_data">
<div>                            <div id="f54a1189-af65-471a-b213-6a48894f5db1" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("f54a1189-af65-471a-b213-6a48894f5db1")) {                    Plotly.newPlot(                        "f54a1189-af65-471a-b213-6a48894f5db1",                        [{"hovertemplate":"split=train\u003cbr\u003efold_id=%{x}\u003cbr\u003escore=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"train","line":{"color":"#636efa","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"train","orientation":"v","showlegend":true,"x":[0,1,2,3,4],"xaxis":"x","y":[0.824050403866116,0.8229102911854095,0.8856084616106042,0.8221267198759311,0.8160866634574893],"yaxis":"y","type":"scatter"},{"hovertemplate":"split=val\u003cbr\u003efold_id=%{x}\u003cbr\u003escore=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"val","line":{"color":"#EF553B","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"val","orientation":"v","showlegend":true,"x":[0,1,2,3,4],"xaxis":"x","y":[0.833631037240138,0.8282932270623933,0.4015437666982662,0.8436797007283516,0.8707880180201437],"yaxis":"y","type":"scatter"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"fold_id"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"score"}},"legend":{"title":{"text":"split"},"tracegroupgap":0},"title":{"text":"Mean Val Score: 0.76, Mean Train Score: 0.83"}},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('f54a1189-af65-471a-b213-6a48894f5db1');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
<div class="output stream stderr">
<pre><code>/opt/conda/lib/python3.10/site-packages/plotly/express/_core.py:2065: FutureWarning:

When grouping with a length-1 list-like, you will need to pass a length-1 tuple to get_group in a future version of pandas. Pass `(name,)` instead of `name` to silence this warning.

</code></pre>
</div>
<div class="output display_data">
<div>                            <div id="07c067c4-efb3-4f78-ae4f-65fe21e99136" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("07c067c4-efb3-4f78-ae4f-65fe21e99136")) {                    Plotly.newPlot(                        "07c067c4-efb3-4f78-ae4f-65fe21e99136",                        [{"hovertemplate":"split=train\u003cbr\u003efold_id=%{x}\u003cbr\u003eloss=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"train","line":{"color":"#636efa","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"train","orientation":"v","showlegend":true,"x":[0,1,2,3,4],"xaxis":"x","y":[32395.37359625327,33070.17062085636,27272.536419711734,33509.60750038516,34778.32550185222],"yaxis":"y","type":"scatter"},{"hovertemplate":"split=val\u003cbr\u003efold_id=%{x}\u003cbr\u003eloss=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"val","line":{"color":"#EF553B","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"val","orientation":"v","showlegend":true,"x":[0,1,2,3,4],"xaxis":"x","y":[35722.600900823396,34168.41115576481,57500.16066678674,31329.721180140306,25987.948229109992],"yaxis":"y","type":"scatter"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"fold_id"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"loss"}},"legend":{"title":{"text":"split"},"tracegroupgap":0},"title":{"text":"Mean Val Loss: 36941.77, Mean Train Loss: 32205.20"}},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('07c067c4-efb3-4f78-ae4f-65fe21e99136');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
<div class="output display_data">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>fold_id</th>
      <th>split</th>
      <th>score</th>
      <th>loss</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>train</td>
      <td>0.824050</td>
      <td>32395.373596</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>val</td>
      <td>0.833631</td>
      <td>35722.600901</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>train</td>
      <td>0.822910</td>
      <td>33070.170621</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>val</td>
      <td>0.828293</td>
      <td>34168.411156</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2</td>
      <td>train</td>
      <td>0.885608</td>
      <td>27272.536420</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2</td>
      <td>val</td>
      <td>0.401544</td>
      <td>57500.160667</td>
    </tr>
    <tr>
      <th>6</th>
      <td>3</td>
      <td>train</td>
      <td>0.822127</td>
      <td>33509.607500</td>
    </tr>
    <tr>
      <th>7</th>
      <td>3</td>
      <td>val</td>
      <td>0.843680</td>
      <td>31329.721180</td>
    </tr>
    <tr>
      <th>8</th>
      <td>4</td>
      <td>train</td>
      <td>0.816087</td>
      <td>34778.325502</td>
    </tr>
    <tr>
      <th>9</th>
      <td>4</td>
      <td>val</td>
      <td>0.870788</td>
      <td>25987.948229</td>
    </tr>
  </tbody>
</table>
</div>
</div>
<div class="output stream stdout">
<pre><code>mean cv val score: 0.76
mean cv val loss 36941.77
mean cv train score: 0.83
mean cv train loss 32205.20
</code></pre>
</div>
</div>
<div class="cell markdown">
<ul>
<li>with boostrap</li>
</ul>
</div>
<div class="cell code" data-execution_count="89"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-08-09T11:26:22.519810Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-08-09T11:26:22.519122Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-08-09T11:26:22.709349Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-08-09T11:26:22.707957Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-08-09T11:26:22.519775Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb78"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get score with bootstrap bagging</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>bag_SGD_boot_model <span class="op">=</span> BaggingRegressor(base_estimator<span class="op">=</span>SGDRegressor(),</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>                                   n_estimators<span class="op">=</span><span class="dv">20</span>, random_state<span class="op">=</span><span class="dv">42</span>,</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>                                   bootstrap<span class="op">=</span><span class="va">True</span>).fit(X_selected_features_lr, t)</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;Accuracy score for classification:&#39;</span>)</span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;bag_boot_model&#39;</span>, bag_SGD_boot_model.score(X_selected_features_lr, t))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Accuracy score for classification:
bag_boot_model 0.8282598339064007
</code></pre>
</div>
<div class="output stream stderr">
<pre><code>/opt/conda/lib/python3.10/site-packages/sklearn/ensemble/_base.py:166: FutureWarning:

`base_estimator` was renamed to `estimator` in version 1.2 and will be removed in 1.4.

</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="83"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-08-09T11:01:48.718404Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-08-09T11:01:48.717951Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-08-09T11:01:50.142234Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-08-09T11:01:50.141100Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-08-09T11:01:48.718344Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb81"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>evaluate_model(X_selected_features_lr, bag_SGD_boot_model)</span></code></pre></div>
<div class="output stream stderr">
<pre><code>/opt/conda/lib/python3.10/site-packages/sklearn/ensemble/_base.py:166: FutureWarning:

`base_estimator` was renamed to `estimator` in version 1.2 and will be removed in 1.4.

/opt/conda/lib/python3.10/site-packages/sklearn/ensemble/_base.py:166: FutureWarning:

`base_estimator` was renamed to `estimator` in version 1.2 and will be removed in 1.4.

/opt/conda/lib/python3.10/site-packages/sklearn/ensemble/_base.py:166: FutureWarning:

`base_estimator` was renamed to `estimator` in version 1.2 and will be removed in 1.4.

/opt/conda/lib/python3.10/site-packages/sklearn/ensemble/_base.py:166: FutureWarning:

`base_estimator` was renamed to `estimator` in version 1.2 and will be removed in 1.4.

/opt/conda/lib/python3.10/site-packages/sklearn/ensemble/_base.py:166: FutureWarning:

`base_estimator` was renamed to `estimator` in version 1.2 and will be removed in 1.4.

/opt/conda/lib/python3.10/site-packages/plotly/express/_core.py:2065: FutureWarning:

When grouping with a length-1 list-like, you will need to pass a length-1 tuple to get_group in a future version of pandas. Pass `(name,)` instead of `name` to silence this warning.

</code></pre>
</div>
<div class="output display_data">
<div>                            <div id="b1b0a9c8-2054-43e5-9cca-2a136c427abf" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("b1b0a9c8-2054-43e5-9cca-2a136c427abf")) {                    Plotly.newPlot(                        "b1b0a9c8-2054-43e5-9cca-2a136c427abf",                        [{"hovertemplate":"split=train\u003cbr\u003efold_id=%{x}\u003cbr\u003escore=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"train","line":{"color":"#636efa","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"train","orientation":"v","showlegend":true,"x":[0,1,2,3,4],"xaxis":"x","y":[0.8163573189795964,0.8234611838805441,0.8843275341727603,0.8211974445551413,0.816090482285274],"yaxis":"y","type":"scatter"},{"hovertemplate":"split=val\u003cbr\u003efold_id=%{x}\u003cbr\u003escore=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"val","line":{"color":"#EF553B","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"val","orientation":"v","showlegend":true,"x":[0,1,2,3,4],"xaxis":"x","y":[0.8495466520771183,0.8417524880829673,0.40088397836813616,0.844368608594178,0.8704184973482941],"yaxis":"y","type":"scatter"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"fold_id"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"score"}},"legend":{"title":{"text":"split"},"tracegroupgap":0},"title":{"text":"Mean Val Score: 0.76, Mean Train Score: 0.83"}},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('b1b0a9c8-2054-43e5-9cca-2a136c427abf');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
<div class="output stream stderr">
<pre><code>/opt/conda/lib/python3.10/site-packages/plotly/express/_core.py:2065: FutureWarning:

When grouping with a length-1 list-like, you will need to pass a length-1 tuple to get_group in a future version of pandas. Pass `(name,)` instead of `name` to silence this warning.

</code></pre>
</div>
<div class="output display_data">
<div>                            <div id="8d4f315f-aae6-4395-b825-35943f6abea2" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("8d4f315f-aae6-4395-b825-35943f6abea2")) {                    Plotly.newPlot(                        "8d4f315f-aae6-4395-b825-35943f6abea2",                        [{"hovertemplate":"split=train\u003cbr\u003efold_id=%{x}\u003cbr\u003eloss=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"train","line":{"color":"#636efa","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"train","orientation":"v","showlegend":true,"x":[0,1,2,3,4],"xaxis":"x","y":[33096.012189119116,33018.693022567786,27424.80680843113,33597.026717847555,34777.96442655535],"yaxis":"y","type":"scatter"},{"hovertemplate":"split=val\u003cbr\u003efold_id=%{x}\u003cbr\u003eloss=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"val","line":{"color":"#EF553B","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"val","orientation":"v","showlegend":true,"x":[0,1,2,3,4],"xaxis":"x","y":[33970.961975368344,32801.938993471515,57531.848434536485,31260.609479551676,26025.081891224145],"yaxis":"y","type":"scatter"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"fold_id"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"loss"}},"legend":{"title":{"text":"split"},"tracegroupgap":0},"title":{"text":"Mean Val Loss: 36318.09, Mean Train Loss: 32382.90"}},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('8d4f315f-aae6-4395-b825-35943f6abea2');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
<div class="output display_data">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>fold_id</th>
      <th>split</th>
      <th>score</th>
      <th>loss</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>train</td>
      <td>0.816357</td>
      <td>33096.012189</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>val</td>
      <td>0.849547</td>
      <td>33970.961975</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>train</td>
      <td>0.823461</td>
      <td>33018.693023</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>val</td>
      <td>0.841752</td>
      <td>32801.938993</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2</td>
      <td>train</td>
      <td>0.884328</td>
      <td>27424.806808</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2</td>
      <td>val</td>
      <td>0.400884</td>
      <td>57531.848435</td>
    </tr>
    <tr>
      <th>6</th>
      <td>3</td>
      <td>train</td>
      <td>0.821197</td>
      <td>33597.026718</td>
    </tr>
    <tr>
      <th>7</th>
      <td>3</td>
      <td>val</td>
      <td>0.844369</td>
      <td>31260.609480</td>
    </tr>
    <tr>
      <th>8</th>
      <td>4</td>
      <td>train</td>
      <td>0.816090</td>
      <td>34777.964427</td>
    </tr>
    <tr>
      <th>9</th>
      <td>4</td>
      <td>val</td>
      <td>0.870418</td>
      <td>26025.081891</td>
    </tr>
  </tbody>
</table>
</div>
</div>
<div class="output stream stdout">
<pre><code>mean cv val score: 0.76
mean cv val loss 36318.09
mean cv train score: 0.83
mean cv train loss 32382.90
</code></pre>
</div>
</div>
<section id="boosting" class="cell markdown">
<h3>Boosting</h3>
</section>
<div class="cell code" data-execution_count="84"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-08-09T11:01:50.144485Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-08-09T11:01:50.143971Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-08-09T11:01:50.291293Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-08-09T11:01:50.290105Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-08-09T11:01:50.144451Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb85"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> AdaBoostRegressor</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="co"># get score with ada boosting</span></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>ada_boost_model <span class="op">=</span> AdaBoostRegressor(n_estimators<span class="op">=</span><span class="dv">20</span>, random_state<span class="op">=</span><span class="dv">42</span>).fit(X_selected_features_lr, t)</span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;Accuracy score for classification:&#39;</span>)</span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;ada_boost_model&#39;</span>, ada_boost_model.score(X_selected_features_lr, t).mean())</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Accuracy score for classification:
ada_boost_model 0.859668073435088
</code></pre>
</div>
</div>
<section id="random-forest" class="cell markdown">
<h3>random forest</h3>
</section>
<div class="cell code" data-execution_count="85"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-08-09T11:01:50.293726Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-08-09T11:01:50.292942Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-08-09T11:02:02.095824Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-08-09T11:02:02.094166Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-08-09T11:01:50.293691Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb87"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co"># show accuracy of random forest classifier on data</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> RandomForestRegressor</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;RandomForestClassifier score:&#39;</span>,</span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>      cross_val_score(</span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>          RandomForestRegressor(random_state<span class="op">=</span><span class="dv">42</span>, max_depth<span class="op">=</span><span class="dv">6</span>),</span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a>           X_selected_features_lr, t, cv<span class="op">=</span><span class="dv">15</span>).mean())</span></code></pre></div>
<div class="output stream stdout">
<pre><code>RandomForestClassifier score: 0.8339821574938402
</code></pre>
</div>
</div>
<section id="voting" class="cell markdown">
<h2>voting</h2>
</section>
<div class="cell markdown">
<ul>
<li>voting regressors</li>
<li>voting ensembles</li>
</ul>
</div>
<div class="cell markdown">
<p>Unsurprisingly, the better voting score is from the voting ensemble.
If all your options have better scores individually, it's no surprise
that your score is also better when combining them.</p>
</div>
<section id="voting-regressors" class="cell markdown">
<h3>voting regressors</h3>
</section>
<div class="cell code" data-execution_count="93"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-08-09T11:32:54.718542Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-08-09T11:32:54.717301Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-08-09T11:51:08.252201Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-08-09T11:51:08.250932Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-08-09T11:32:54.718491Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb89"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> KFold</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> mean_squared_error</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Modeling step: Test different algorithms</span></span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a>K_fold <span class="op">=</span> KFold(n_splits<span class="op">=</span><span class="dv">10</span>, shuffle<span class="op">=</span><span class="va">True</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a>models <span class="op">=</span> [] </span>
<span id="cb89-11"><a href="#cb89-11" aria-hidden="true" tabindex="-1"></a>cv_results <span class="op">=</span> [] </span>
<span id="cb89-12"><a href="#cb89-12" aria-hidden="true" tabindex="-1"></a>cv_means <span class="op">=</span> []</span>
<span id="cb89-13"><a href="#cb89-13" aria-hidden="true" tabindex="-1"></a>cv_std <span class="op">=</span> [] </span>
<span id="cb89-14"><a href="#cb89-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-15"><a href="#cb89-15" aria-hidden="true" tabindex="-1"></a>models.append(gs_lw_model_backward)</span>
<span id="cb89-16"><a href="#cb89-16" aria-hidden="true" tabindex="-1"></a>models.append(gs_neigh_model_backward)</span>
<span id="cb89-17"><a href="#cb89-17" aria-hidden="true" tabindex="-1"></a>models.append(gs_tree_model)</span>
<span id="cb89-18"><a href="#cb89-18" aria-hidden="true" tabindex="-1"></a>models.append(gs_svm_model_backward)</span>
<span id="cb89-19"><a href="#cb89-19" aria-hidden="true" tabindex="-1"></a>models.append(gs_model)</span>
<span id="cb89-20"><a href="#cb89-20" aria-hidden="true" tabindex="-1"></a>models.append(ada_boost_model)</span>
<span id="cb89-21"><a href="#cb89-21" aria-hidden="true" tabindex="-1"></a>models.append(bag_SGD_boot_model)</span>
<span id="cb89-22"><a href="#cb89-22" aria-hidden="true" tabindex="-1"></a>models.append(bag_SGD_model)</span>
<span id="cb89-23"><a href="#cb89-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-24"><a href="#cb89-24" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> model <span class="kw">in</span> models:</span>
<span id="cb89-25"><a href="#cb89-25" aria-hidden="true" tabindex="-1"></a>    cv_results.append(cross_val_score(model, arr_X, t, </span>
<span id="cb89-26"><a href="#cb89-26" aria-hidden="true" tabindex="-1"></a>                                       scoring<span class="op">=</span><span class="st">&quot;neg_root_mean_squared_error&quot;</span>, cv<span class="op">=</span>K_fold, n_jobs<span class="op">=</span><span class="dv">6</span>))</span>
<span id="cb89-27"><a href="#cb89-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-28"><a href="#cb89-28" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> cv_result <span class="kw">in</span> cv_results:</span>
<span id="cb89-29"><a href="#cb89-29" aria-hidden="true" tabindex="-1"></a>    cv_means.append(cv_result.mean())  <span class="co"># Taking square root to convert back to RMSE</span></span>
<span id="cb89-30"><a href="#cb89-30" aria-hidden="true" tabindex="-1"></a>    cv_std.append(cv_result.std())  <span class="co"># Taking square root to convert back to RMSE</span></span>
<span id="cb89-31"><a href="#cb89-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-32"><a href="#cb89-32" aria-hidden="true" tabindex="-1"></a>cv_frame <span class="op">=</span> pd.DataFrame(</span>
<span id="cb89-33"><a href="#cb89-33" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb89-34"><a href="#cb89-34" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;CrossValMeans&quot;</span>: cv_means,</span>
<span id="cb89-35"><a href="#cb89-35" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;CrossValErrors&quot;</span>: cv_std,</span>
<span id="cb89-36"><a href="#cb89-36" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;Algorithms&quot;</span>: [<span class="st">&quot;LWLR&quot;</span>,</span>
<span id="cb89-37"><a href="#cb89-37" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;KNN&quot;</span>, </span>
<span id="cb89-38"><a href="#cb89-38" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;DecisionTree&quot;</span>,</span>
<span id="cb89-39"><a href="#cb89-39" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;SVM&quot;</span>, </span>
<span id="cb89-40"><a href="#cb89-40" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;PCA_SGD&quot;</span>,</span>
<span id="cb89-41"><a href="#cb89-41" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;AdaBoost&quot;</span>, </span>
<span id="cb89-42"><a href="#cb89-42" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;BaggingRegressor_bootstrap&quot;</span>,   </span>
<span id="cb89-43"><a href="#cb89-43" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;BaggingRegressor&quot;</span>,]</span>
<span id="cb89-44"><a href="#cb89-44" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb89-45"><a href="#cb89-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-46"><a href="#cb89-46" aria-hidden="true" tabindex="-1"></a>cv_plot <span class="op">=</span> sns.barplot(x<span class="op">=</span><span class="st">&quot;CrossValMeans&quot;</span>, y<span class="op">=</span><span class="st">&quot;Algorithms&quot;</span>, data<span class="op">=</span>cv_frame,</span>
<span id="cb89-47"><a href="#cb89-47" aria-hidden="true" tabindex="-1"></a>                      palette<span class="op">=</span><span class="st">&quot;husl&quot;</span>, orient<span class="op">=</span><span class="st">&quot;h&quot;</span>, <span class="op">**</span>{<span class="st">&#39;xerr&#39;</span>: cv_std},</span>
<span id="cb89-48"><a href="#cb89-48" aria-hidden="true" tabindex="-1"></a>                      order<span class="op">=</span>cv_frame.sort_values(<span class="st">&#39;CrossValMeans&#39;</span>, ascending<span class="op">=</span><span class="va">False</span>).Algorithms)</span>
<span id="cb89-49"><a href="#cb89-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-50"><a href="#cb89-50" aria-hidden="true" tabindex="-1"></a>cv_plot.set_xlabel(<span class="st">&quot;Negative Root Mean Squared Error (RMSE)&quot;</span>)</span>
<span id="cb89-51"><a href="#cb89-51" aria-hidden="true" tabindex="-1"></a>cv_plot.set_title(<span class="st">&quot;CV Negative RMSE Scores&quot;</span>)</span></code></pre></div>
<div class="output stream stderr">
<pre><code>/opt/conda/lib/python3.10/site-packages/sklearn/ensemble/_base.py:166: FutureWarning: `base_estimator` was renamed to `estimator` in version 1.2 and will be removed in 1.4.
  warnings.warn(
/opt/conda/lib/python3.10/site-packages/sklearn/ensemble/_base.py:166: FutureWarning: `base_estimator` was renamed to `estimator` in version 1.2 and will be removed in 1.4.
  warnings.warn(
/opt/conda/lib/python3.10/site-packages/sklearn/ensemble/_base.py:166: FutureWarning: `base_estimator` was renamed to `estimator` in version 1.2 and will be removed in 1.4.
  warnings.warn(
/opt/conda/lib/python3.10/site-packages/sklearn/ensemble/_base.py:166: FutureWarning: `base_estimator` was renamed to `estimator` in version 1.2 and will be removed in 1.4.
  warnings.warn(
/opt/conda/lib/python3.10/site-packages/sklearn/ensemble/_base.py:166: FutureWarning: `base_estimator` was renamed to `estimator` in version 1.2 and will be removed in 1.4.
  warnings.warn(
/opt/conda/lib/python3.10/site-packages/sklearn/ensemble/_base.py:166: FutureWarning: `base_estimator` was renamed to `estimator` in version 1.2 and will be removed in 1.4.
  warnings.warn(
/opt/conda/lib/python3.10/site-packages/sklearn/ensemble/_base.py:166: FutureWarning: `base_estimator` was renamed to `estimator` in version 1.2 and will be removed in 1.4.
  warnings.warn(
/opt/conda/lib/python3.10/site-packages/sklearn/ensemble/_base.py:166: FutureWarning: `base_estimator` was renamed to `estimator` in version 1.2 and will be removed in 1.4.
  warnings.warn(
/opt/conda/lib/python3.10/site-packages/sklearn/ensemble/_base.py:166: FutureWarning: `base_estimator` was renamed to `estimator` in version 1.2 and will be removed in 1.4.
  warnings.warn(
/opt/conda/lib/python3.10/site-packages/sklearn/ensemble/_base.py:166: FutureWarning: `base_estimator` was renamed to `estimator` in version 1.2 and will be removed in 1.4.
  warnings.warn(
</code></pre>
</div>
<div class="output execute_result" data-execution_count="93">
<pre><code>Text(0.5, 1.0, &#39;CV Negative RMSE Scores&#39;)</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_4fa37495b4184bc2901899a734acb6ec/48330b92cdb8ab7f16eb3c50f003444811ed7dda.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="94"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-08-09T11:51:21.577334Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-08-09T11:51:21.576899Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-08-09T11:51:21.585137Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-08-09T11:51:21.583731Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-08-09T11:51:21.577294Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb92"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> VotingRegressor</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> voting_reg(models):</span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>    vote_reg <span class="op">=</span> VotingRegressor(estimators<span class="op">=</span>models, n_jobs<span class="op">=</span><span class="dv">4</span>)</span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a>    vote_reg <span class="op">=</span> vote_reg.fit(X_selected_features_lr, t)</span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a>    scores <span class="op">=</span> cross_val_score(vote_reg, X_selected_features_lr, t, cv<span class="op">=</span>K_fold, n_jobs<span class="op">=</span><span class="dv">6</span>, scoring<span class="op">=</span><span class="st">&#39;neg_root_mean_squared_error&#39;</span>)</span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-10"><a href="#cb92-10" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;Negative Root Mean Squared Error scores:&quot;</span>, scores)</span>
<span id="cb92-11"><a href="#cb92-11" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;Mean Negative Root Mean Squared Error:&quot;</span>, <span class="bu">round</span>(np.mean(scores), <span class="dv">2</span>))</span>
<span id="cb92-12"><a href="#cb92-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-13"><a href="#cb92-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> vote_reg</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="95"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-08-09T11:51:25.845628Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-08-09T11:51:25.844541Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-08-09T11:51:41.182430Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-08-09T11:51:41.181050Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-08-09T11:51:25.845578Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb93"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>best_models <span class="op">=</span> [</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>    (<span class="st">&#39;bag&#39;</span>, bag_SGD_model),</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>    (<span class="st">&#39;Ada_Boost&#39;</span>, ada_boost_model),</span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>    (<span class="st">&#39;KNN&#39;</span>, gs_neigh_model_backward),</span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>    (<span class="st">&#39;bas_boost&#39;</span>, bag_SGD_boot_model)</span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a>vot_reg_model <span class="op">=</span> voting_reg(best_models)</span>
<span id="cb93-9"><a href="#cb93-9" aria-hidden="true" tabindex="-1"></a>evaluate_model(X_selected_features_lr, vot_reg_model)</span></code></pre></div>
<div class="output stream stderr">
<pre><code>/opt/conda/lib/python3.10/site-packages/sklearn/ensemble/_base.py:166: FutureWarning: `base_estimator` was renamed to `estimator` in version 1.2 and will be removed in 1.4.
  warnings.warn(
/opt/conda/lib/python3.10/site-packages/sklearn/ensemble/_base.py:166: FutureWarning: `base_estimator` was renamed to `estimator` in version 1.2 and will be removed in 1.4.
  warnings.warn(
/opt/conda/lib/python3.10/site-packages/sklearn/ensemble/_base.py:166: FutureWarning: `base_estimator` was renamed to `estimator` in version 1.2 and will be removed in 1.4.
  warnings.warn(
/opt/conda/lib/python3.10/site-packages/sklearn/ensemble/_base.py:166: FutureWarning: `base_estimator` was renamed to `estimator` in version 1.2 and will be removed in 1.4.
  warnings.warn(
/opt/conda/lib/python3.10/site-packages/sklearn/ensemble/_base.py:166: FutureWarning: `base_estimator` was renamed to `estimator` in version 1.2 and will be removed in 1.4.
  warnings.warn(
/opt/conda/lib/python3.10/site-packages/sklearn/ensemble/_base.py:166: FutureWarning: `base_estimator` was renamed to `estimator` in version 1.2 and will be removed in 1.4.
  warnings.warn(
/opt/conda/lib/python3.10/site-packages/sklearn/ensemble/_base.py:166: FutureWarning: `base_estimator` was renamed to `estimator` in version 1.2 and will be removed in 1.4.
  warnings.warn(
/opt/conda/lib/python3.10/site-packages/sklearn/ensemble/_base.py:166: FutureWarning: `base_estimator` was renamed to `estimator` in version 1.2 and will be removed in 1.4.
  warnings.warn(
/opt/conda/lib/python3.10/site-packages/sklearn/ensemble/_base.py:166: FutureWarning: `base_estimator` was renamed to `estimator` in version 1.2 and will be removed in 1.4.
  warnings.warn(
/opt/conda/lib/python3.10/site-packages/sklearn/ensemble/_base.py:166: FutureWarning: `base_estimator` was renamed to `estimator` in version 1.2 and will be removed in 1.4.
  warnings.warn(
/opt/conda/lib/python3.10/site-packages/sklearn/ensemble/_base.py:166: FutureWarning: `base_estimator` was renamed to `estimator` in version 1.2 and will be removed in 1.4.
  warnings.warn(
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>Negative Root Mean Squared Error scores: [-36560.53087152 -29305.175916   -23027.24062673 -36389.02335538
 -39103.66057209 -45360.83157576 -33429.08332143 -26750.54120654
 -25169.92708003 -22520.85299931]
Mean Negative Root Mean Squared Error: -31761.69
</code></pre>
</div>
<div class="output stream stderr">
<pre><code>/opt/conda/lib/python3.10/site-packages/sklearn/ensemble/_base.py:166: FutureWarning: `base_estimator` was renamed to `estimator` in version 1.2 and will be removed in 1.4.
  warnings.warn(
/opt/conda/lib/python3.10/site-packages/sklearn/ensemble/_base.py:166: FutureWarning: `base_estimator` was renamed to `estimator` in version 1.2 and will be removed in 1.4.
  warnings.warn(
/opt/conda/lib/python3.10/site-packages/sklearn/ensemble/_base.py:166: FutureWarning: `base_estimator` was renamed to `estimator` in version 1.2 and will be removed in 1.4.
  warnings.warn(
/opt/conda/lib/python3.10/site-packages/sklearn/ensemble/_base.py:166: FutureWarning: `base_estimator` was renamed to `estimator` in version 1.2 and will be removed in 1.4.
  warnings.warn(
/opt/conda/lib/python3.10/site-packages/sklearn/ensemble/_base.py:166: FutureWarning: `base_estimator` was renamed to `estimator` in version 1.2 and will be removed in 1.4.
  warnings.warn(
/opt/conda/lib/python3.10/site-packages/plotly/express/_core.py:2065: FutureWarning:

When grouping with a length-1 list-like, you will need to pass a length-1 tuple to get_group in a future version of pandas. Pass `(name,)` instead of `name` to silence this warning.

</code></pre>
</div>
<div class="output display_data">
<div>                            <div id="b9c4f702-3815-4198-a51c-be5615f9baba" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("b9c4f702-3815-4198-a51c-be5615f9baba")) {                    Plotly.newPlot(                        "b9c4f702-3815-4198-a51c-be5615f9baba",                        [{"hovertemplate":"split=train\u003cbr\u003efold_id=%{x}\u003cbr\u003escore=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"train","line":{"color":"#636efa","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"train","orientation":"v","showlegend":true,"x":[0,1,2,3,4],"xaxis":"x","y":[0.9266169678182121,0.9270698495522254,0.9498860116240353,0.9300055606763538,0.9259959469301449],"yaxis":"y","type":"scatter"},{"hovertemplate":"split=val\u003cbr\u003efold_id=%{x}\u003cbr\u003escore=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"val","line":{"color":"#EF553B","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"val","orientation":"v","showlegend":true,"x":[0,1,2,3,4],"xaxis":"x","y":[0.8592233914660965,0.8644160575307974,0.5716040179006503,0.8616909549882603,0.887710927867866],"yaxis":"y","type":"scatter"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"fold_id"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"score"}},"legend":{"title":{"text":"split"},"tracegroupgap":0},"title":{"text":"Mean Val Score: 0.81, Mean Train Score: 0.93"}},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('b9c4f702-3815-4198-a51c-be5615f9baba');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
<div class="output stream stderr">
<pre><code>/opt/conda/lib/python3.10/site-packages/plotly/express/_core.py:2065: FutureWarning:

When grouping with a length-1 list-like, you will need to pass a length-1 tuple to get_group in a future version of pandas. Pass `(name,)` instead of `name` to silence this warning.

</code></pre>
</div>
<div class="output display_data">
<div>                            <div id="b089ed9e-135b-4959-b70e-735590d9cd37" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("b089ed9e-135b-4959-b70e-735590d9cd37")) {                    Plotly.newPlot(                        "b089ed9e-135b-4959-b70e-735590d9cd37",                        [{"hovertemplate":"split=train\u003cbr\u003efold_id=%{x}\u003cbr\u003eloss=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"train","line":{"color":"#636efa","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"train","orientation":"v","showlegend":true,"x":[0,1,2,3,4],"xaxis":"x","y":[20921.204374237008,21222.342951225768,18051.282546427934,21020.63123960547,22061.234405511335],"yaxis":"y","type":"scatter"},{"hovertemplate":"split=val\u003cbr\u003efold_id=%{x}\u003cbr\u003eloss=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"val","line":{"color":"#EF553B","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"val","orientation":"v","showlegend":true,"x":[0,1,2,3,4],"xaxis":"x","y":[32860.348595176576,30362.337282430795,48649.18345096422,29469.592618214814,24226.425766112014],"yaxis":"y","type":"scatter"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"fold_id"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"loss"}},"legend":{"title":{"text":"split"},"tracegroupgap":0},"title":{"text":"Mean Val Loss: 33113.58, Mean Train Loss: 20655.34"}},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('b089ed9e-135b-4959-b70e-735590d9cd37');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
<div class="output display_data">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>fold_id</th>
      <th>split</th>
      <th>score</th>
      <th>loss</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>train</td>
      <td>0.926617</td>
      <td>20921.204374</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>val</td>
      <td>0.859223</td>
      <td>32860.348595</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>train</td>
      <td>0.927070</td>
      <td>21222.342951</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>val</td>
      <td>0.864416</td>
      <td>30362.337282</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2</td>
      <td>train</td>
      <td>0.949886</td>
      <td>18051.282546</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2</td>
      <td>val</td>
      <td>0.571604</td>
      <td>48649.183451</td>
    </tr>
    <tr>
      <th>6</th>
      <td>3</td>
      <td>train</td>
      <td>0.930006</td>
      <td>21020.631240</td>
    </tr>
    <tr>
      <th>7</th>
      <td>3</td>
      <td>val</td>
      <td>0.861691</td>
      <td>29469.592618</td>
    </tr>
    <tr>
      <th>8</th>
      <td>4</td>
      <td>train</td>
      <td>0.925996</td>
      <td>22061.234406</td>
    </tr>
    <tr>
      <th>9</th>
      <td>4</td>
      <td>val</td>
      <td>0.887711</td>
      <td>24226.425766</td>
    </tr>
  </tbody>
</table>
</div>
</div>
<div class="output stream stdout">
<pre><code>mean cv val score: 0.81
mean cv val loss 33113.58
mean cv train score: 0.93
mean cv train loss 20655.34
</code></pre>
</div>
</div>
<section id="voting-of-ensembles" class="cell markdown">
<h3>voting of ensembles</h3>
</section>
<div class="cell code" data-execution_count="96"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-08-09T11:51:57.718583Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-08-09T11:51:57.718097Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-08-09T11:57:33.761781Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-08-09T11:57:33.760531Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-08-09T11:51:57.718541Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb99"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co"># show accuracy of voting ensemble classifier on data</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>estimators <span class="op">=</span> [(<span class="st">&#39;abr&#39;</span>, AdaBoostRegressor(n_estimators<span class="op">=</span><span class="dv">100</span>, random_state<span class="op">=</span><span class="dv">42</span>)), </span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>              (<span class="st">&#39;rf&#39;</span>, RandomForestRegressor(random_state<span class="op">=</span><span class="dv">42</span>, max_depth<span class="op">=</span><span class="dv">6</span>)), </span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>              (<span class="st">&#39;br&#39;</span>, BaggingRegressor(estimator<span class="op">=</span>SGDRegressor(alpha<span class="op">=</span>rs_model.best_params_[<span class="st">&#39;alpha&#39;</span>], </span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a>                                                         eta0<span class="op">=</span>rs_model.best_params_[<span class="st">&#39;eta0&#39;</span>], </span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a>                                                         penalty<span class="op">=</span>rs_model.best_params_[<span class="st">&#39;penalty&#39;</span>], </span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a>                                                         random_state<span class="op">=</span><span class="dv">42</span>),</span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a>                                   n_estimators<span class="op">=</span><span class="dv">20</span>, random_state<span class="op">=</span><span class="dv">42</span>,</span>
<span id="cb99-10"><a href="#cb99-10" aria-hidden="true" tabindex="-1"></a>                                   bootstrap<span class="op">=</span><span class="va">False</span>)),</span>
<span id="cb99-11"><a href="#cb99-11" aria-hidden="true" tabindex="-1"></a>              (<span class="st">&#39;svr&#39;</span>, gs_svm_model_backward)]</span>
<span id="cb99-12"><a href="#cb99-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-13"><a href="#cb99-13" aria-hidden="true" tabindex="-1"></a>vclf1111 <span class="op">=</span> VotingRegressor(estimators<span class="op">=</span>estimators, weights<span class="op">=</span>[<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>]).fit(X_selected_features_lr, t)</span>
<span id="cb99-14"><a href="#cb99-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-15"><a href="#cb99-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;Voting Classifier score:&#39;</span>, cross_val_score(vclf1111, X_selected_features_lr, t, cv<span class="op">=</span><span class="dv">15</span>).mean())</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Voting Classifier score: 0.8464923468870637
</code></pre>
</div>
</div>
<section id="pca-implementation-for-chosen-models"
class="cell markdown">
<h1>PCA Implementation for Chosen Models</h1>
</section>
<div class="cell code" data-execution_count="97"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-08-09T11:57:44.903315Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-08-09T11:57:44.902298Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-08-09T12:02:21.270941Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-08-09T12:02:21.269650Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-08-09T11:57:44.903243Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb101"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define a Pipeline including PCA and LWLR regressor</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>pipeline <span class="op">=</span> Pipeline([</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>    (<span class="st">&#39;pca&#39;</span>, PCA()),</span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>    (<span class="st">&#39;vclf&#39;</span>, gs_svm_model_backward)</span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>]).fit(X_selected_features_lr,t)</span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-8"><a href="#cb101-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;Voting Classifier score:&#39;</span>, cross_val_score(pipeline, X_selected_features_lr, t, cv<span class="op">=</span><span class="dv">15</span>).mean())</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Voting Classifier score: 0.8128142209862211
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="98"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-08-09T12:06:13.038048Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-08-09T12:06:13.037623Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-08-09T12:06:16.235862Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-08-09T12:06:16.234784Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-08-09T12:06:13.038020Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb103"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define a Pipeline including PCA and LWLR regressor</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>pipeline <span class="op">=</span> Pipeline([</span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>    (<span class="st">&#39;pca&#39;</span>, PCA()),</span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>    (<span class="st">&#39;vclf&#39;</span>, bag_SGD_boot_model)  <span class="co"># Initial &#39;k&#39; value, will be tuned</span></span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a>]).fit(X_selected_features_lr,t)</span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-7"><a href="#cb103-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-8"><a href="#cb103-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;Voting Classifier score:&#39;</span>, cross_val_score(pipeline, X_selected_features_lr, t, cv<span class="op">=</span><span class="dv">15</span>).mean())</span></code></pre></div>
<div class="output stream stderr">
<pre><code>/opt/conda/lib/python3.10/site-packages/sklearn/ensemble/_base.py:166: FutureWarning:

`base_estimator` was renamed to `estimator` in version 1.2 and will be removed in 1.4.

/opt/conda/lib/python3.10/site-packages/sklearn/ensemble/_base.py:166: FutureWarning:

`base_estimator` was renamed to `estimator` in version 1.2 and will be removed in 1.4.

/opt/conda/lib/python3.10/site-packages/sklearn/ensemble/_base.py:166: FutureWarning:

`base_estimator` was renamed to `estimator` in version 1.2 and will be removed in 1.4.

/opt/conda/lib/python3.10/site-packages/sklearn/ensemble/_base.py:166: FutureWarning:

`base_estimator` was renamed to `estimator` in version 1.2 and will be removed in 1.4.

/opt/conda/lib/python3.10/site-packages/sklearn/ensemble/_base.py:166: FutureWarning:

`base_estimator` was renamed to `estimator` in version 1.2 and will be removed in 1.4.

/opt/conda/lib/python3.10/site-packages/sklearn/ensemble/_base.py:166: FutureWarning:

`base_estimator` was renamed to `estimator` in version 1.2 and will be removed in 1.4.

/opt/conda/lib/python3.10/site-packages/sklearn/ensemble/_base.py:166: FutureWarning:

`base_estimator` was renamed to `estimator` in version 1.2 and will be removed in 1.4.

/opt/conda/lib/python3.10/site-packages/sklearn/ensemble/_base.py:166: FutureWarning:

`base_estimator` was renamed to `estimator` in version 1.2 and will be removed in 1.4.

/opt/conda/lib/python3.10/site-packages/sklearn/ensemble/_base.py:166: FutureWarning:

`base_estimator` was renamed to `estimator` in version 1.2 and will be removed in 1.4.

/opt/conda/lib/python3.10/site-packages/sklearn/ensemble/_base.py:166: FutureWarning:

`base_estimator` was renamed to `estimator` in version 1.2 and will be removed in 1.4.

/opt/conda/lib/python3.10/site-packages/sklearn/ensemble/_base.py:166: FutureWarning:

`base_estimator` was renamed to `estimator` in version 1.2 and will be removed in 1.4.

/opt/conda/lib/python3.10/site-packages/sklearn/ensemble/_base.py:166: FutureWarning:

`base_estimator` was renamed to `estimator` in version 1.2 and will be removed in 1.4.

/opt/conda/lib/python3.10/site-packages/sklearn/ensemble/_base.py:166: FutureWarning:

`base_estimator` was renamed to `estimator` in version 1.2 and will be removed in 1.4.

/opt/conda/lib/python3.10/site-packages/sklearn/ensemble/_base.py:166: FutureWarning:

`base_estimator` was renamed to `estimator` in version 1.2 and will be removed in 1.4.

/opt/conda/lib/python3.10/site-packages/sklearn/ensemble/_base.py:166: FutureWarning:

`base_estimator` was renamed to `estimator` in version 1.2 and will be removed in 1.4.

</code></pre>
</div>
<div class="output stream stdout">
<pre><code>Voting Classifier score: 0.8034809058489426
</code></pre>
</div>
<div class="output stream stderr">
<pre><code>/opt/conda/lib/python3.10/site-packages/sklearn/ensemble/_base.py:166: FutureWarning:

`base_estimator` was renamed to `estimator` in version 1.2 and will be removed in 1.4.

</code></pre>
</div>
</div>
<section id="submission" class="cell markdown">
<h1>submission</h1>
</section>
<div class="cell code" data-execution_count="111"
data-execution="{&quot;iopub.execute_input&quot;:&quot;2024-08-09T12:41:49.619821Z&quot;,&quot;iopub.status.busy&quot;:&quot;2024-08-09T12:41:49.619412Z&quot;,&quot;iopub.status.idle&quot;:&quot;2024-08-09T12:41:58.871153Z&quot;,&quot;shell.execute_reply&quot;:&quot;2024-08-09T12:41:58.869576Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2024-08-09T12:41:49.619789Z&quot;}"
data-trusted="true">
<div class="sourceCode" id="cb107"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create the submission file</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>submission[<span class="st">&#39;SalePrice&#39;</span>] <span class="op">=</span> voting_reg(best_models).predict(test_encoded[X_selected_features_lr.columns])</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>submission.to_csv(<span class="st">&#39;submission2.csv&#39;</span>, index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>display(submission)</span></code></pre></div>
<div class="output stream stderr">
<pre><code>/opt/conda/lib/python3.10/site-packages/sklearn/ensemble/_base.py:166: FutureWarning: `base_estimator` was renamed to `estimator` in version 1.2 and will be removed in 1.4.
  warnings.warn(
/opt/conda/lib/python3.10/site-packages/sklearn/ensemble/_base.py:166: FutureWarning: `base_estimator` was renamed to `estimator` in version 1.2 and will be removed in 1.4.
  warnings.warn(
/opt/conda/lib/python3.10/site-packages/sklearn/ensemble/_base.py:166: FutureWarning: `base_estimator` was renamed to `estimator` in version 1.2 and will be removed in 1.4.
  warnings.warn(
/opt/conda/lib/python3.10/site-packages/sklearn/ensemble/_base.py:166: FutureWarning: `base_estimator` was renamed to `estimator` in version 1.2 and will be removed in 1.4.
  warnings.warn(
/opt/conda/lib/python3.10/site-packages/sklearn/ensemble/_base.py:166: FutureWarning: `base_estimator` was renamed to `estimator` in version 1.2 and will be removed in 1.4.
  warnings.warn(
/opt/conda/lib/python3.10/site-packages/sklearn/ensemble/_base.py:166: FutureWarning: `base_estimator` was renamed to `estimator` in version 1.2 and will be removed in 1.4.
  warnings.warn(
/opt/conda/lib/python3.10/site-packages/sklearn/ensemble/_base.py:166: FutureWarning: `base_estimator` was renamed to `estimator` in version 1.2 and will be removed in 1.4.
  warnings.warn(
/opt/conda/lib/python3.10/site-packages/sklearn/ensemble/_base.py:166: FutureWarning: `base_estimator` was renamed to `estimator` in version 1.2 and will be removed in 1.4.
  warnings.warn(
/opt/conda/lib/python3.10/site-packages/sklearn/ensemble/_base.py:166: FutureWarning: `base_estimator` was renamed to `estimator` in version 1.2 and will be removed in 1.4.
  warnings.warn(
/opt/conda/lib/python3.10/site-packages/sklearn/ensemble/_base.py:166: FutureWarning: `base_estimator` was renamed to `estimator` in version 1.2 and will be removed in 1.4.
  warnings.warn(
/opt/conda/lib/python3.10/site-packages/sklearn/ensemble/_base.py:166: FutureWarning: `base_estimator` was renamed to `estimator` in version 1.2 and will be removed in 1.4.
  warnings.warn(
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>Negative Root Mean Squared Error scores: [-36560.53087152 -29305.175916   -23027.24062673 -36389.02335538
 -39103.66057209 -45360.83157576 -33429.08332143 -26750.54120654
 -25169.92708003 -22520.85299931]
Mean Negative Root Mean Squared Error: -31761.69
</code></pre>
</div>
<div class="output display_data">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Id</th>
      <th>SalePrice</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1461</td>
      <td>109291.585731</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1462</td>
      <td>148886.260037</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1463</td>
      <td>175418.646499</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1464</td>
      <td>186637.830837</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1465</td>
      <td>178660.471148</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1454</th>
      <td>2915</td>
      <td>80409.202621</td>
    </tr>
    <tr>
      <th>1455</th>
      <td>2916</td>
      <td>76690.017956</td>
    </tr>
    <tr>
      <th>1456</th>
      <td>2917</td>
      <td>133561.157513</td>
    </tr>
    <tr>
      <th>1457</th>
      <td>2918</td>
      <td>119057.431700</td>
    </tr>
    <tr>
      <th>1458</th>
      <td>2919</td>
      <td>239443.645386</td>
    </tr>
  </tbody>
</table>
<p>1459 rows × 2 columns</p>
</div>
</div>
</div>
<section id="submmisions-screenshots" class="cell markdown">
<h1>Submmisions ScreenShots</h1>
</section>
<div class="cell markdown">
<p><img
src="vertopal_4fa37495b4184bc2901899a734acb6ec/2a154c8c-829a-474b-9b47-85efcd1d42df.png"
alt="image.png" /></p>
</div>
<div class="cell markdown">
<p><img
src="vertopal_4fa37495b4184bc2901899a734acb6ec/de151941-01cf-4026-8cec-7ffbed024a1e.png"
alt="image.png" /></p>
</div>
<section id="leaderboard" class="cell markdown">
<h1>LeaderBoard</h1>
</section>
<div class="cell markdown">
<p><img
src="vertopal_4fa37495b4184bc2901899a734acb6ec/50480e4c-0d49-477c-8bef-3e07788d4901.png"
alt="image.png" /></p>
</div>
<div class="cell markdown">
<h1 id="project-summary">Project Summary:</h1>
<p>In this project, we evaluated various machine learning models to
predict house prices, including LWLR, KNN, Decision Trees, SVM, and
ensembles like Bagging and Boosting. We also implemented PCA for feature
reduction and tested the impact on model performance. The LWLR model
achieved the highest R² score of 0.8586, indicating it was particularly
effective for this regression task. However, when combining multiple
models using Voting Regressors, we achieved a strong balance between
accuracy and loss, with a mean cross-validation score of 0.81 and
significantly lower training loss.</p>
<h1 id="conclusion">Conclusion:</h1>
<p>The Voting Regressor, which aggregates predictions from several
models, offers the best overall performance, making it the optimal
choice for the final model.</p>
</div>
</body>
</html>
